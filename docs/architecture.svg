<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2122px" preserveAspectRatio="none" style="width:9256px;height:2122px;" version="1.1" viewBox="0 0 9256 2122" width="9256px" zoomAndPan="magnify"><defs><filter height="1" id="bfz8uhd9wvday0" width="1" x="0" y="0"><feFlood flood-color="#E8F5E9" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bfz8uhd9wvday1" width="1" x="0" y="0"><feFlood flood-color="#E3F2FD" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bfz8uhd9wvday2" width="1" x="0" y="0"><feFlood flood-color="#FFF3E0" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bfz8uhd9wvday3" width="1" x="0" y="0"><feFlood flood-color="#F3E5F5" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bfz8uhd9wvday4" width="1" x="0" y="0"><feFlood flood-color="#FFEBEE" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bfz8uhd9wvday5" width="1" x="0" y="0"><feFlood flood-color="#E0F7FA" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bfz8uhd9wvday6" width="1" x="0" y="0"><feFlood flood-color="#FFF9C4" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="522" x="4373" y="16.708">A Contrario Character Clustering — Complete Architecture</text><rect fill="#DDDDDD" height="116.4375" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="202" x="8" y="28.9531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="34" x="18" y="46.1636">Color</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="60" y="46.1636">Package</text><text fill="#000000" filter="url(#bfz8uhd9wvday0)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="58.9683"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="60" y="58.9683">Detection (OCR / CRAFT)</text><text fill="#000000" filter="url(#bfz8uhd9wvday1)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="71.7729"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="60" y="71.7729">Patch Processing</text><text fill="#000000" filter="url(#bfz8uhd9wvday2)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="84.5776"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="60" y="84.5776">Clustering &amp; A Contrario</text><text fill="#000000" filter="url(#bfz8uhd9wvday3)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="97.3823"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="60" y="97.3823">Registration</text><text fill="#000000" filter="url(#bfz8uhd9wvday4)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="110.187"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="60" y="110.187">Refinement</text><text fill="#000000" filter="url(#bfz8uhd9wvday5)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="122.9917"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="60" y="122.9917">Evaluation &amp; Metrics</text><text fill="#000000" filter="url(#bfz8uhd9wvday6)" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="30" y="135.7964"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="60" y="135.7964">Utilities &amp; Reporting</text><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="35.9531" y2="35.9531"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="48.7578" y2="48.7578"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="61.5625" y2="61.5625"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="74.3672" y2="74.3672"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="87.1719" y2="87.1719"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="99.9766" y2="99.9766"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="112.7813" y2="112.7813"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="125.5859" y2="125.5859"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="204" y1="138.3906" y2="138.3906"/><line style="stroke: #000000; stroke-width: 1.0;" x1="14" x2="14" y1="35.9531" y2="138.3906"/><line style="stroke: #000000; stroke-width: 1.0;" x1="56" x2="56" y1="35.9531" y2="138.3906"/><line style="stroke: #000000; stroke-width: 1.0;" x1="204" x2="204" y1="35.9531" y2="138.3906"/><!--MD5=[d8bc3f76135e051e883e634ef9da7f79]
cluster utils_pkg--><polygon fill="#FFF9C4" points="1058,1070.3906,1127,1070.3906,1134,1092.6875,1776,1092.6875,1776,1341.3906,1058,1341.3906,1058,1070.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1058" x2="1134" y1="1092.6875" y2="1092.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="1062" y="1085.3857">src.utils</text><!--MD5=[ed3e76ab9c78a8bcdb94d5b54a11af0d]
cluster report_pkg--><polygon fill="#FFF9C4" points="3258,844.3906,3386,844.3906,3393,866.6875,3744,866.6875,3744,990.3906,3258,990.3906,3258,844.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="3258" x2="3393" y1="866.6875" y2="866.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="3262" y="859.3857">src.auto_report</text><!--MD5=[450cd87ad1e6f702709af008ae5421ff]
cluster ocr_pkg--><polygon fill="#E8F5E9" points="22,463.8906,267,463.8906,274,486.1875,1034,486.1875,1034,1277.3906,22,1277.3906,22,463.8906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="274" y1="486.1875" y2="486.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="239" x="26" y="478.8857">src.ocr — Character Detection</text><!--MD5=[3041c499d6be10f44f704c28abde0d96]
cluster patch_pkg--><polygon fill="#E3F2FD" points="2009,470.3906,2353,470.3906,2360,492.6875,2828,492.6875,2828,1266.3906,2009,1266.3906,2009,470.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2009" x2="2360" y1="492.6875" y2="492.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="338" x="2013" y="485.3857">src.patch_processing — Feature Extraction</text><!--MD5=[b6862e9304fab4601fd1c44bff6fdc8f]
cluster vec_pkg--><polygon fill="#E3F2FD" points="1717,837.8906,1856,837.8906,1863,860.1875,1985,860.1875,1985,996.8906,1717,996.8906,1717,837.8906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1717" x2="1863" y1="860.1875" y2="860.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="1721" y="852.8857">src.vectorization</text><!--MD5=[5d3e1c6d17d7f120a0c8af8b604cac52]
cluster ac_pkg--><polygon fill="#FFF3E0" points="3768,814.8906,4091,814.8906,4098,837.1875,4226,837.1875,4226,1290.3906,3768,1290.3906,3768,814.8906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="3768" x2="4098" y1="837.1875" y2="837.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="317" x="3772" y="829.8857">src.clustering — A Contrario Framework</text><!--MD5=[85a24cf9ed5697ba1b84441b78e6c75a]
cluster graph_pkg--><polygon fill="#FFF3E0" points="6079,496.3906,6352,496.3906,6359,518.6875,7174,518.6875,7174,1266.3906,6079,1266.3906,6079,496.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="6079" x2="6359" y1="518.6875" y2="518.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="267" x="6083" y="511.3857">src.clustering — Graph Clustering</text><!--MD5=[9eeaa9fee6cd2c58b8baa442d0ba639a]
cluster sweep_pkg--><polygon fill="#FFF3E0" points="2852,413.3906,3152,413.3906,3159,435.6875,3234,435.6875,3234,977.8906,2852,977.8906,2852,413.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="2852" x2="3159" y1="435.6875" y2="435.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="294" x="2856" y="428.3857">src.clustering — Sweep Orchestrator</text><!--MD5=[c7b648e955d1f4e130d01c2abc069b68]
cluster refine_pkg--><polygon fill="#FFEBEE" points="4250,856.8906,4529,856.8906,4536,879.1875,5709,879.1875,5709,1291.8906,4250,1291.8906,4250,856.8906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="4250" x2="4536" y1="879.1875" y2="879.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="273" x="4254" y="871.8857">src.clustering — Refinement Steps</text><!--MD5=[4d2e014b63bf46fab75858be88490cf9]
cluster refine_eng--><polygon fill="#FFEBEE" points="4566,1387.3906,4862,1387.3906,4869,1409.6875,5122,1409.6875,5122,1610.3906,4566,1610.3906,4566,1387.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="4566" x2="4869" y1="1409.6875" y2="1409.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="290" x="4570" y="1402.3857">src.clustering — Refinement Engines</text><!--MD5=[426864f950e272a596fea8cfa372b617]
cluster post_pkg--><polygon fill="#FFF3E0" points="5733,831.3906,5974,831.3906,5981,853.6875,6055,853.6875,6055,1003.3906,5733,1003.3906,5733,831.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="5733" x2="5981" y1="853.6875" y2="853.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="235" x="5737" y="846.3857">src.clustering.post_clustering</text><!--MD5=[736d7b8c3e46a2c5d8e9a84854d797a3]
cluster reg_pkg--><polygon fill="#F3E5F5" points="6049,1416.3906,6332,1416.3906,6339,1438.6875,6943,1438.6875,6943,2072.3906,6049,2072.3906,6049,1416.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="6049" x2="6339" y1="1438.6875" y2="1438.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="277" x="6053" y="1431.3857">src.registration — Image Alignment</text><!--MD5=[df3bd4f0c4c84f30af4ac8e2ac29270c]
cluster align_pkg--><polygon fill="#F3E5F5" points="7198,808.3906,7491,808.3906,7498,830.6875,7835,830.6875,7835,1278.8906,7198,1278.8906,7198,808.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="7198" x2="7498" y1="830.6875" y2="830.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="287" x="7202" y="823.3857">src.registration — Cluster Alignment</text><!--MD5=[207c4071813ffadb64d4e86686f8a5dd]
cluster deform_pkg--><polygon fill="#FFF3E0" points="7820,178.3906,8131,178.3906,8138,200.6875,8459,200.6875,8459,680.3906,7820,680.3906,7820,178.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="7820" x2="8138" y1="200.6875" y2="200.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="305" x="7824" y="193.3857">src.clustering — Deformation Features</text><!--MD5=[4a740a53bc6a41cc7b17654b814a877d]
cluster eval_pkg--><polygon fill="#E0F7FA" points="8483,181.3906,8702,181.3906,8709,203.6875,9234,203.6875,9234,700.3906,8483,700.3906,8483,181.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="8483" x2="8709" y1="203.6875" y2="203.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="213" x="8487" y="196.3857">src.clustering — Evaluation</text><!--MD5=[0ab84a74fea5ffc846a294e29c2bbc3a]
cluster layout_pkg--><polygon fill="#E3F2FD" points="7198,203.8906,7352,203.8906,7359,226.1875,7796,226.1875,7796,642.8906,7198,642.8906,7198,203.8906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="7198" x2="7359" y1="226.1875" y2="226.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="7202" y="218.8857">src.layout_analysis</text><!--MD5=[61423fb4df4f9f6a83e3c94ddaa14069]
cluster chat_pkg--><polygon fill="#E8F5E9" points="1467,850.8906,1568,850.8906,1575,873.1875,1693,873.1875,1693,983.8906,1467,983.8906,1467,850.8906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1467" x2="1575" y1="873.1875" y2="873.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="1471" y="865.8857">src.ocr.chat</text><!--MD5=[70c5c0fe1af96029de2a450d24e4dbe7]
cluster scripts_pkg--><polygon fill="#FFFFFF" points="1734,208.3906,1794,208.3906,1801,230.6875,2546,230.6875,2546,339.3906,1734,339.3906,1734,208.3906" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1734" x2="1801" y1="230.6875" y2="230.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="1738" y="223.3857">scripts</text><!--MD5=[ec537af378a9732798a8d48fba95b4e9]
class connectedComponent--><rect fill="#FEFEFE" height="220.3984" id="connectedComponent" style="stroke: #444444; stroke-width: 1.5;" width="292" x="1215" y="1105.3906"/><ellipse cx="1286.25" cy="1124.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M1287.5625,1128.125 Q1287.1875,1128.3281 1286.7656,1128.4219 Q1286.3594,1128.5156 1285.8906,1128.5156 Q1284.2813,1128.5156 1283.4219,1127.4531 Q1282.5625,1126.375 1282.5625,1124.3594 Q1282.5625,1122.3281 1283.4219,1121.2656 Q1284.2813,1120.1875 1285.8906,1120.1875 Q1286.3594,1120.1875 1286.7656,1120.2969 Q1287.1875,1120.3906 1287.5625,1120.5781 L1287.5625,1122.3438 Q1287.1406,1121.9688 1286.75,1121.7969 Q1286.375,1121.625 1285.9688,1121.625 Q1285.1094,1121.625 1284.6563,1122.3125 Q1284.2188,1123 1284.2188,1124.3594 Q1284.2188,1125.7188 1284.6563,1126.4063 Q1285.1094,1127.0938 1285.9688,1127.0938 Q1286.375,1127.0938 1286.75,1126.9219 Q1287.1406,1126.75 1287.5625,1126.3594 L1287.5625,1128.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="1340.25" y="1120.6011">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1303.75" y="1135.2622">connectedComponent</text><line style="stroke: #444444; stroke-width: 1.5;" x1="1216" x2="1506" y1="1143.3281" y2="1143.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="1221" y="1157.5386">_labels : ndarray</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="1221" y="1170.3433">_regions : List[RegionProperties]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="1221" y="1183.1479">_deleted_labels : set</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="1221" y="1195.9526">_merge_mapping : dict</text><line style="stroke: #444444; stroke-width: 1.0;" x1="1216" x2="1506" y1="1202.5469" y2="1202.5469"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="1221" y="1216.7573">+from_image(image, connectivity) : CC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="1221" y="1229.562">+from_labels(labels, stats, intensity_image) : CC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="1221" y="1242.3667">+from_image_watershed(image, ...) : CC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="1221" y="1255.1714">+delete(label, reason)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="1221" y="1267.9761">+merge(link_matrix, labels_list)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="1221" y="1280.7808">+save(filepath) / load(filepath)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="1221" y="1293.5854">+labels : ndarray  «property»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="154" x="1221" y="1306.3901">+regions : List  «property»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="1221" y="1319.1948">+segm_img : ndarray  «property»</text><!--MD5=[1b844c90688aafb95cd8c95626c3b83a]
class Timer--><rect fill="#FEFEFE" height="56.8047" id="Timer" style="stroke: #444444; stroke-width: 1.5;" width="105" x="1074.5" y="1186.8906"/><ellipse cx="1105.95" cy="1200.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M1107.2625,1204.6563 Q1106.8875,1204.8594 1106.4656,1204.9531 Q1106.0594,1205.0469 1105.5906,1205.0469 Q1103.9813,1205.0469 1103.1219,1203.9844 Q1102.2625,1202.9063 1102.2625,1200.8906 Q1102.2625,1198.8594 1103.1219,1197.7969 Q1103.9813,1196.7188 1105.5906,1196.7188 Q1106.0594,1196.7188 1106.4656,1196.8281 Q1106.8875,1196.9219 1107.2625,1197.1094 L1107.2625,1198.875 Q1106.8406,1198.5 1106.45,1198.3281 Q1106.075,1198.1563 1105.6688,1198.1563 Q1104.8094,1198.1563 1104.3563,1198.8438 Q1103.9188,1199.5313 1103.9188,1200.8906 Q1103.9188,1202.25 1104.3563,1202.9375 Q1104.8094,1203.625 1105.6688,1203.625 Q1106.075,1203.625 1106.45,1203.4531 Q1106.8406,1203.2813 1107.2625,1202.8906 L1107.2625,1204.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1122.05" y="1205.3911">Timer</text><line style="stroke: #444444; stroke-width: 1.5;" x1="1075.5" x2="1178.5" y1="1214.8906" y2="1214.8906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="1075.5" x2="1178.5" y1="1222.8906" y2="1222.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="1080.5" y="1237.1011">+__call__(string)</text><path d="M1542.5,1191.3906 L1542.5,1211.3906 L1507.27,1215.3906 L1542.5,1219.3906 L1542.5,1239.8047 A0,0 0 0 0 1542.5,1239.8047 L1759.5,1239.8047 A0,0 0 0 0 1759.5,1239.8047 L1759.5,1201.3906 L1749.5,1191.3906 L1542.5,1191.3906 A0,0 0 0 0 1542.5,1191.3906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1749.5,1191.3906 L1749.5,1201.3906 L1759.5,1201.3906 L1749.5,1191.3906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="1548.5" y="1206.6011">Central data structure carrying</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="1548.5" y="1219.4058">segmented character components</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="1548.5" y="1232.2104">across the entire pipeline.</text><!--MD5=[54b8c2100e9a2a7b55d37ecc41568f1a]
class AutoReport--><rect fill="#FEFEFE" height="95.2188" id="AutoReport" style="stroke: #444444; stroke-width: 1.5;" width="216" x="3512" y="879.3906"/><ellipse cx="3580.25" cy="893.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M3581.5625,897.1563 Q3581.1875,897.3594 3580.7656,897.4531 Q3580.3594,897.5469 3579.8906,897.5469 Q3578.2813,897.5469 3577.4219,896.4844 Q3576.5625,895.4063 3576.5625,893.3906 Q3576.5625,891.3594 3577.4219,890.2969 Q3578.2813,889.2188 3579.8906,889.2188 Q3580.3594,889.2188 3580.7656,889.3281 Q3581.1875,889.4219 3581.5625,889.6094 L3581.5625,891.375 Q3581.1406,891 3580.75,890.8281 Q3580.375,890.6563 3579.9688,890.6563 Q3579.1094,890.6563 3578.6563,891.3438 Q3578.2188,892.0313 3578.2188,893.3906 Q3578.2188,894.75 3578.6563,895.4375 Q3579.1094,896.125 3579.9688,896.125 Q3580.375,896.125 3580.75,895.9531 Q3581.1406,895.7813 3581.5625,895.3906 L3581.5625,897.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3597.75" y="897.8911">AutoReport</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3513" x2="3727" y1="907.3906" y2="907.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="3518" y="921.6011">+title, author, output_dir</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3513" x2="3727" y1="928.1953" y2="928.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="3518" y="942.4058">+section(name) «context manager»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="3518" y="955.2104">+report_figure(fig, title)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="44" x="3518" y="968.0151">+save()</text><!--MD5=[c45e1c124aadb0dc63bfea4761640fa6]
class ReportConfig--><rect fill="#FEFEFE" height="79.5469" id="ReportConfig" style="stroke: #444444; stroke-width: 1.5;" width="203" x="3273.5" y="886.8906"/><ellipse cx="3330.25" cy="905.8594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M3331.5625,909.625 Q3331.1875,909.8281 3330.7656,909.9219 Q3330.3594,910.0156 3329.8906,910.0156 Q3328.2813,910.0156 3327.4219,908.9531 Q3326.5625,907.875 3326.5625,905.8594 Q3326.5625,903.8281 3327.4219,902.7656 Q3328.2813,901.6875 3329.8906,901.6875 Q3330.3594,901.6875 3330.7656,901.7969 Q3331.1875,901.8906 3331.5625,902.0781 L3331.5625,903.8438 Q3331.1406,903.4688 3330.75,903.2969 Q3330.375,903.125 3329.9688,903.125 Q3329.1094,903.125 3328.6563,903.8125 Q3328.2188,904.5 3328.2188,905.8594 Q3328.2188,907.2188 3328.6563,907.9063 Q3329.1094,908.5938 3329.9688,908.5938 Q3330.375,908.5938 3330.75,908.4219 Q3331.1406,908.25 3331.5625,907.8594 L3331.5625,909.625 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="3354.25" y="902.1011">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="3347.75" y="916.7622">ReportConfig</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3274.5" x2="3475.5" y1="924.8281" y2="924.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="3279.5" y="939.0386">dpi, output_format, image_quality</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="3279.5" y="951.8433">theme, show_progress</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3274.5" x2="3475.5" y1="958.4375" y2="958.4375"/><!--MD5=[8d5f213226c47178ed2f34e2e08e3f80]
class GlobalPipeline--><rect fill="#FEFEFE" height="198.7891" id="GlobalPipeline" style="stroke: #444444; stroke-width: 1.5;" width="326" x="692" y="498.8906"/><ellipse cx="806.75" cy="517.8594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M808.0625,521.625 Q807.6875,521.8281 807.2656,521.9219 Q806.8594,522.0156 806.3906,522.0156 Q804.7813,522.0156 803.9219,520.9531 Q803.0625,519.875 803.0625,517.8594 Q803.0625,515.8281 803.9219,514.7656 Q804.7813,513.6875 806.3906,513.6875 Q806.8594,513.6875 807.2656,513.7969 Q807.6875,513.8906 808.0625,514.0781 L808.0625,515.8438 Q807.6406,515.4688 807.25,515.2969 Q806.875,515.125 806.4688,515.125 Q805.6094,515.125 805.1563,515.8125 Q804.7188,516.5 804.7188,517.8594 Q804.7188,519.2188 805.1563,519.9063 Q805.6094,520.5938 806.4688,520.5938 Q806.875,520.5938 807.25,520.4219 Q807.6406,520.25 808.0625,519.8594 L808.0625,521.625 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="85" x="826.25" y="514.1011">«orchestrator»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="824.25" y="528.7622">GlobalPipeline</text><line style="stroke: #444444; stroke-width: 1.5;" x1="693" x2="1017" y1="536.8281" y2="536.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="698" y="551.0386">craftDetector : craftWrapper</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="698" y="563.8433">imageComponentsPipeline : imageComponentsPipeline</text><line style="stroke: #444444; stroke-width: 1.0;" x1="693" x2="1017" y1="570.4375" y2="570.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="249" x="698" y="584.6479">+forward(img_pil, verbose) : PipelineOutput</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="698" y="614.2573">1. CRAFT detection (score maps)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="698" y="627.062">2. Watershed segmentation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="698" y="639.8667">3. Component filtering &amp; merging</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="698" y="652.6714">4. Binarization</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="698" y="665.4761">5. Image component extraction</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="217" x="698" y="678.2808">6. CRAFT↔image component matching</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="698" y="691.0854">7. Character filtering</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="693" x2="828.5" y1="597.6445" y2="597.6445"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="828.5" y="600.9526">substeps</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="881.5" x2="1017" y1="597.6445" y2="597.6445"/><!--MD5=[63a3f40881423d8da06995c2410c83f4]
class craftWrapper--><rect fill="#FEFEFE" height="105.1563" id="craftWrapper" style="stroke: #444444; stroke-width: 1.5;" width="368" x="38" y="874.3906"/><ellipse cx="177.25" cy="893.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M178.5625,897.125 Q178.1875,897.3281 177.7656,897.4219 Q177.3594,897.5156 176.8906,897.5156 Q175.2813,897.5156 174.4219,896.4531 Q173.5625,895.375 173.5625,893.3594 Q173.5625,891.3281 174.4219,890.2656 Q175.2813,889.1875 176.8906,889.1875 Q177.3594,889.1875 177.7656,889.2969 Q178.1875,889.3906 178.5625,889.5781 L178.5625,891.3438 Q178.1406,890.9688 177.75,890.7969 Q177.375,890.625 176.9688,890.625 Q176.1094,890.625 175.6563,891.3125 Q175.2188,892 175.2188,893.3594 Q175.2188,894.7188 175.6563,895.4063 Q176.1094,896.0938 176.9688,896.0938 Q177.375,896.0938 177.75,895.9219 Q178.1406,895.75 178.5625,895.3594 L178.5625,897.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="72" x="199.75" y="889.6011">«nn.Module»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="194.75" y="904.2622">craftWrapper</text><line style="stroke: #444444; stroke-width: 1.5;" x1="39" x2="405" y1="912.3281" y2="912.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="44" y="926.5386">model : CRAFT</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="44" y="939.3433">params : craftParams</text><line style="stroke: #444444; stroke-width: 1.0;" x1="39" x2="405" y1="945.9375" y2="945.9375"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="356" x="44" y="960.1479">+forward(img_tensor) : (preprocessed, score_text, score_link)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="318" x="44" y="972.9526">+map_original_to_preprocessed(points, original_shape)</text><!--MD5=[e8343f0b895d348a02da620e949b8b58]
class imageComponentsPipeline--><rect fill="#FEFEFE" height="159.2422" id="imageComponentsPipeline" style="stroke: #444444; stroke-width: 1.5;" width="303" x="714.5" y="847.3906"/><ellipse cx="776.75" cy="861.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M778.0625,865.1563 Q777.6875,865.3594 777.2656,865.4531 Q776.8594,865.5469 776.3906,865.5469 Q774.7813,865.5469 773.9219,864.4844 Q773.0625,863.4063 773.0625,861.3906 Q773.0625,859.3594 773.9219,858.2969 Q774.7813,857.2188 776.3906,857.2188 Q776.8594,857.2188 777.2656,857.3281 Q777.6875,857.4219 778.0625,857.6094 L778.0625,859.375 Q777.6406,859 777.25,858.8281 Q776.875,858.6563 776.4688,858.6563 Q775.6094,858.6563 775.1563,859.3438 Q774.7188,860.0313 774.7188,861.3906 Q774.7188,862.75 775.1563,863.4375 Q775.6094,864.125 776.4688,864.125 Q776.875,864.125 777.25,863.9531 Q777.6406,863.7813 778.0625,863.3906 L778.0625,865.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="794.25" y="865.8911">imageComponentsPipeline</text><line style="stroke: #444444; stroke-width: 1.5;" x1="715.5" x2="1016.5" y1="875.3906" y2="875.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="207" x="720.5" y="889.6011">params : imageComponentsParams</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="720.5" y="902.4058">craftDetector : craftWrapper</text><line style="stroke: #444444; stroke-width: 1.0;" x1="715.5" x2="1016.5" y1="909" y2="909"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="285" x="720.5" y="923.2104">+forward(im_pil, craftComponents) : compsResult</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="720.5" y="936.0151">-binarize(im_pil) : ndarray</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="720.5" y="948.8198">-filter_image_components(cc) : cc</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="273" x="720.5" y="961.6245">-compute_similarities(imgCC, craftCC) : ndarray</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="291" x="720.5" y="974.4292">-merge_from_similarities(imgCC, craftCC, sim) : cc</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="720.5" y="987.2339">-filter_bad_characters(cc) : cc</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="720.5" y="1000.0386">-filter_centroids_by_contour_proximity(...)</text><!--MD5=[9ce31c500415aa0365347e6e2b4078cc]
class PipelineOutput--><rect fill="#FEFEFE" height="117.9609" id="PipelineOutput" style="stroke: #444444; stroke-width: 1.5;" width="238" x="441" y="867.8906"/><ellipse cx="509.75" cy="886.8594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M511.0625,890.625 Q510.6875,890.8281 510.2656,890.9219 Q509.8594,891.0156 509.3906,891.0156 Q507.7813,891.0156 506.9219,889.9531 Q506.0625,888.875 506.0625,886.8594 Q506.0625,884.8281 506.9219,883.7656 Q507.7813,882.6875 509.3906,882.6875 Q509.8594,882.6875 510.2656,882.7969 Q510.6875,882.8906 511.0625,883.0781 L511.0625,884.8438 Q510.6406,884.4688 510.25,884.2969 Q509.875,884.125 509.4688,884.125 Q508.6094,884.125 508.1563,884.8125 Q507.7188,885.5 507.7188,886.8594 Q507.7188,888.2188 508.1563,888.9063 Q508.6094,889.5938 509.4688,889.5938 Q509.875,889.5938 510.25,889.4219 Q510.6406,889.25 511.0625,888.8594 L511.0625,890.625 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="85" x="531.25" y="883.1011">«NamedTuple»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="527.25" y="897.7622">PipelineOutput</text><line style="stroke: #444444; stroke-width: 1.5;" x1="442" x2="678" y1="905.8281" y2="905.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="447" y="920.0386">img_pil, preprocessed, binary_img</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="447" y="932.8433">score_text, score_link</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="447" y="945.6479">craft_components, image_components</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="447" y="958.4526">filtered_image_components, characters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="447" y="971.2573">similarity_matrix</text><line style="stroke: #444444; stroke-width: 1.5;" x1="442" x2="678" y1="977.8516" y2="977.8516"/><!--MD5=[f44e7e795d950a0032891dd34728746d]
class compsResult--><rect fill="#FEFEFE" height="92.3516" id="compsResult" style="stroke: #444444; stroke-width: 1.5;" width="224" x="754" y="1169.3906"/><ellipse cx="821.25" cy="1188.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M822.5625,1192.125 Q822.1875,1192.3281 821.7656,1192.4219 Q821.3594,1192.5156 820.8906,1192.5156 Q819.2813,1192.5156 818.4219,1191.4531 Q817.5625,1190.375 817.5625,1188.3594 Q817.5625,1186.3281 818.4219,1185.2656 Q819.2813,1184.1875 820.8906,1184.1875 Q821.3594,1184.1875 821.7656,1184.2969 Q822.1875,1184.3906 822.5625,1184.5781 L822.5625,1186.3438 Q822.1406,1185.9688 821.75,1185.7969 Q821.375,1185.625 820.9688,1185.625 Q820.1094,1185.625 819.6563,1186.3125 Q819.2188,1187 819.2188,1188.3594 Q819.2188,1189.7188 819.6563,1190.4063 Q820.1094,1191.0938 820.9688,1191.0938 Q821.375,1191.0938 821.75,1190.9219 Q822.1406,1190.75 822.5625,1190.3594 L822.5625,1192.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="85" x="837.25" y="1184.6011">«NamedTuple»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="838.75" y="1199.2622">compsResult</text><line style="stroke: #444444; stroke-width: 1.5;" x1="755" x2="977" y1="1207.3281" y2="1207.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="760" y="1221.5386">binary_img, img_components</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="760" y="1234.3433">filtered_img_components, characters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="760" y="1247.1479">similarity_matrix</text><line style="stroke: #444444; stroke-width: 1.5;" x1="755" x2="977" y1="1253.7422" y2="1253.7422"/><!--MD5=[4aadd6774feb1610fd2a2a65ac7ed15d]
class PatchPreprocessing--><rect fill="#FEFEFE" height="185.9844" id="PatchPreprocessing" style="stroke: #444444; stroke-width: 1.5;" width="305" x="2025.5" y="505.3906"/><ellipse cx="2111.25" cy="524.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2112.5625,528.125 Q2112.1875,528.3281 2111.7656,528.4219 Q2111.3594,528.5156 2110.8906,528.5156 Q2109.2813,528.5156 2108.4219,527.4531 Q2107.5625,526.375 2107.5625,524.3594 Q2107.5625,522.3281 2108.4219,521.2656 Q2109.2813,520.1875 2110.8906,520.1875 Q2111.3594,520.1875 2111.7656,520.2969 Q2112.1875,520.3906 2112.5625,520.5781 L2112.5625,522.3438 Q2112.1406,521.9688 2111.75,521.7969 Q2111.375,521.625 2110.9688,521.625 Q2110.1094,521.625 2109.6563,522.3125 Q2109.2188,523 2109.2188,524.3594 Q2109.2188,525.7188 2109.6563,526.4063 Q2110.1094,527.0938 2110.9688,527.0938 Q2111.375,527.0938 2111.75,526.9219 Q2112.1406,526.75 2112.5625,526.3594 L2112.5625,528.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="85" x="2149.25" y="520.6011">«orchestrator»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="2128.75" y="535.2622">PatchPreprocessing</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2026.5" x2="2329.5" y1="543.3281" y2="543.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="104" x="2031.5" y="557.5386">ink_filter : InkFilter</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="2031.5" y="570.3433">vectorizer : BinaryShapeVectorizer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="2031.5" y="583.1479">chat_model : ModelWrapper</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="2031.5" y="595.9526">hog_renderer : Renderer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="2031.5" y="608.7573">hog : HOG</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="170" x="2031.5" y="621.562">reading_order : ReadingOrder</text><line style="stroke: #444444; stroke-width: 1.0;" x1="2026.5" x2="2329.5" y1="628.1563" y2="628.1563"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="293" x="2031.5" y="642.3667">+__call__(image_folder, comps_folder) : DataFrame</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="2031.5" y="671.9761">CPU: extract → ink_filter → vectorize → deskew</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="236" x="2031.5" y="684.7808">GPU: OCR (CHAT/Kraken) → HOG features</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="2026.5" x2="2151.5" y1="655.3633" y2="655.3633"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="2151.5" y="658.6714">substeps</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="2204.5" x2="2329.5" y1="655.3633" y2="655.3633"/><!--MD5=[4945c737fad898a5ce312252f730d528]
class Renderer--><rect fill="#FEFEFE" height="143.5703" id="Renderer" style="stroke: #444444; stroke-width: 1.5;" width="312" x="2209" y="854.8906"/><ellipse cx="2332.25" cy="873.8594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2333.5625,877.625 Q2333.1875,877.8281 2332.7656,877.9219 Q2332.3594,878.0156 2331.8906,878.0156 Q2330.2813,878.0156 2329.4219,876.9531 Q2328.5625,875.875 2328.5625,873.8594 Q2328.5625,871.8281 2329.4219,870.7656 Q2330.2813,869.6875 2331.8906,869.6875 Q2332.3594,869.6875 2332.7656,869.7969 Q2333.1875,869.8906 2333.5625,870.0781 L2333.5625,871.8438 Q2333.1406,871.4688 2332.75,871.2969 Q2332.375,871.125 2331.9688,871.125 Q2331.1094,871.125 2330.6563,871.8125 Q2330.2188,872.5 2330.2188,873.8594 Q2330.2188,875.2188 2330.6563,875.9063 Q2331.1094,876.5938 2331.9688,876.5938 Q2332.375,876.5938 2332.75,876.4219 Q2333.1406,876.25 2333.5625,875.8594 L2333.5625,877.625 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="58" x="2349.75" y="870.1011">«Dataset»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2349.75" y="884.7622">Renderer</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2210" x2="2520" y1="892.8281" y2="892.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="2215" y="907.0386">scale, dpi, bin_thresh</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="2215" y="919.8433">canvas_dims : CanvasDimensions</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="175" x="2215" y="932.6479">cached_renders : List[ndarray]</text><line style="stroke: #444444; stroke-width: 1.0;" x1="2210" x2="2520" y1="939.2422" y2="939.2422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="2215" y="953.4526">+__call__(svg_imgs) : self</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="2215" y="966.2573">+__getitem__(idx) : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="2215" y="979.062">-_precompute_canvas()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="2215" y="991.8667">-_place_on_canvas(binary_svg, barycenter) : ndarray</text><!--MD5=[4817198fa53a9f6dbbb6db41612de7e2]
class HOG--><rect fill="#FEFEFE" height="116.0234" id="HOG" style="stroke: #444444; stroke-width: 1.5;" width="255" x="2556.5" y="868.8906"/><ellipse cx="2665.25" cy="882.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2666.5625,886.6563 Q2666.1875,886.8594 2665.7656,886.9531 Q2665.3594,887.0469 2664.8906,887.0469 Q2663.2813,887.0469 2662.4219,885.9844 Q2661.5625,884.9063 2661.5625,882.8906 Q2661.5625,880.8594 2662.4219,879.7969 Q2663.2813,878.7188 2664.8906,878.7188 Q2665.3594,878.7188 2665.7656,878.8281 Q2666.1875,878.9219 2666.5625,879.1094 L2666.5625,880.875 Q2666.1406,880.5 2665.75,880.3281 Q2665.375,880.1563 2664.9688,880.1563 Q2664.1094,880.1563 2663.6563,880.8438 Q2663.2188,881.5313 2663.2188,882.8906 Q2663.2188,884.25 2663.6563,884.9375 Q2664.1094,885.625 2664.9688,885.625 Q2665.375,885.625 2665.75,885.4531 Q2666.1406,885.2813 2666.5625,884.8906 L2666.5625,886.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="2682.75" y="887.3911">HOG</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2557.5" x2="2810.5" y1="896.8906" y2="896.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="155" x="2562.5" y="911.1011">_params : HOGParameters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="188" x="2562.5" y="923.9058">dx_conv, dy_conv : nn.Sequential</text><line style="stroke: #444444; stroke-width: 1.0;" x1="2557.5" x2="2810.5" y1="930.5" y2="930.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="2562.5" y="944.7104">+__call__(batch) : fullHOGOutput</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="2557.5" x2="2810.5" y1="951.3047" y2="951.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="243" x="2562.5" y="965.5151">Computes gradient orientation histograms</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="2562.5" y="978.3198">with trilinear binning on rendered SVGs.</text><!--MD5=[8fb7fff8b98eaa5cc4c1148280a0347c]
class InkFilter--><rect fill="#FEFEFE" height="56.8047" id="InkFilter" style="stroke: #444444; stroke-width: 1.5;" width="149" x="2024.5" y="898.3906"/><ellipse cx="2070.75" cy="912.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2072.0625,916.1563 Q2071.6875,916.3594 2071.2656,916.4531 Q2070.8594,916.5469 2070.3906,916.5469 Q2068.7813,916.5469 2067.9219,915.4844 Q2067.0625,914.4063 2067.0625,912.3906 Q2067.0625,910.3594 2067.9219,909.2969 Q2068.7813,908.2188 2070.3906,908.2188 Q2070.8594,908.2188 2071.2656,908.3281 Q2071.6875,908.4219 2072.0625,908.6094 L2072.0625,910.375 Q2071.6406,910 2071.25,909.8281 Q2070.875,909.6563 2070.4688,909.6563 Q2069.6094,909.6563 2069.1563,910.3438 Q2068.7188,911.0313 2068.7188,912.3906 Q2068.7188,913.75 2069.1563,914.4375 Q2069.6094,915.125 2070.4688,915.125 Q2070.875,915.125 2071.25,914.9531 Q2071.6406,914.7813 2072.0625,914.3906 L2072.0625,916.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="2088.25" y="916.8911">InkFilter</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2025.5" x2="2172.5" y1="926.3906" y2="926.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="2025.5" x2="2172.5" y1="934.3906" y2="934.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="2030.5" y="948.6011">+__call__(patches) : List</text><!--MD5=[feb86f70ebabc1d48b9fc9012bf9009e]
class SVG--><rect fill="#FEFEFE" height="69.6094" id="SVG" style="stroke: #444444; stroke-width: 1.5;" width="266" x="2128" y="1180.3906"/><ellipse cx="2243.25" cy="1194.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2244.5625,1198.1563 Q2244.1875,1198.3594 2243.7656,1198.4531 Q2243.3594,1198.5469 2242.8906,1198.5469 Q2241.2813,1198.5469 2240.4219,1197.4844 Q2239.5625,1196.4063 2239.5625,1194.3906 Q2239.5625,1192.3594 2240.4219,1191.2969 Q2241.2813,1190.2188 2242.8906,1190.2188 Q2243.3594,1190.2188 2243.7656,1190.3281 Q2244.1875,1190.4219 2244.5625,1190.6094 L2244.5625,1192.375 Q2244.1406,1192 2243.75,1191.8281 Q2243.375,1191.6563 2242.9688,1191.6563 Q2242.1094,1191.6563 2241.6563,1192.3438 Q2241.2188,1193.0313 2241.2188,1194.3906 Q2241.2188,1195.75 2241.6563,1196.4375 Q2242.1094,1197.125 2242.9688,1197.125 Q2243.375,1197.125 2243.75,1196.9531 Q2244.1406,1196.7813 2244.5625,1196.3906 L2244.5625,1198.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="2260.75" y="1198.8911">SVG</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2129" x2="2393" y1="1208.3906" y2="1208.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="2129" x2="2393" y1="1216.3906" y2="1216.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="254" x="2134" y="1230.6011">+render(dpi, output_format, scale) : ndarray</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="2134" y="1243.4058">+apply_homography(H)</text><!--MD5=[0d7b055ea6ba32f350afd6fd7344a4de]
class BinaryShapeVectorizer--><rect fill="#FEFEFE" height="108.0234" id="BinaryShapeVectorizer" style="stroke: #444444; stroke-width: 1.5;" width="235" x="1733.5" y="872.8906"/><ellipse cx="1774.25" cy="886.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M1775.5625,890.6563 Q1775.1875,890.8594 1774.7656,890.9531 Q1774.3594,891.0469 1773.8906,891.0469 Q1772.2813,891.0469 1771.4219,889.9844 Q1770.5625,888.9063 1770.5625,886.8906 Q1770.5625,884.8594 1771.4219,883.7969 Q1772.2813,882.7188 1773.8906,882.7188 Q1774.3594,882.7188 1774.7656,882.8281 Q1775.1875,882.9219 1775.5625,883.1094 L1775.5625,884.875 Q1775.1406,884.5 1774.75,884.3281 Q1774.375,884.1563 1773.9688,884.1563 Q1773.1094,884.1563 1772.6563,884.8438 Q1772.2188,885.5313 1772.2188,886.8906 Q1772.2188,888.25 1772.6563,888.9375 Q1773.1094,889.625 1773.9688,889.625 Q1774.375,889.625 1774.75,889.4531 Q1775.1406,889.2813 1775.5625,888.8906 L1775.5625,890.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="1791.75" y="891.3911">BinaryShapeVectorizer</text><line style="stroke: #444444; stroke-width: 1.5;" x1="1734.5" x2="1967.5" y1="900.8906" y2="900.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="1739.5" y="915.1011">config : VectorizerConfig</text><line style="stroke: #444444; stroke-width: 1.0;" x1="1734.5" x2="1967.5" y1="921.6953" y2="921.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="1739.5" y="935.9058">+__call__(patches) : Iterator[(idx, SVG)]</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="1734.5" x2="1765.5" y1="948.9023" y2="948.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="171" x="1765.5" y="952.2104">calls external C++ executable</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="1936.5" x2="1967.5" y1="948.9023" y2="948.9023"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="1734.5" x2="1772" y1="968.1094" y2="968.1094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="1772" y="971.4175">binary patch → SVG contour</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="1930" x2="1967.5" y1="968.1094" y2="968.1094"/><!--MD5=[c749a8986ea720c4cf592517a4452927]
class featureMatching--><rect fill="#FEFEFE" height="154.4375" id="featureMatching" style="stroke: #444444; stroke-width: 1.5;" width="319" x="3784.5" y="849.8906"/><ellipse cx="3888.25" cy="863.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M3889.5625,867.6563 Q3889.1875,867.8594 3888.7656,867.9531 Q3888.3594,868.0469 3887.8906,868.0469 Q3886.2813,868.0469 3885.4219,866.9844 Q3884.5625,865.9063 3884.5625,863.8906 Q3884.5625,861.8594 3885.4219,860.7969 Q3886.2813,859.7188 3887.8906,859.7188 Q3888.3594,859.7188 3888.7656,859.8281 Q3889.1875,859.9219 3889.5625,860.1094 L3889.5625,861.875 Q3889.1406,861.5 3888.75,861.3281 Q3888.375,861.1563 3887.9688,861.1563 Q3887.1094,861.1563 3886.6563,861.8438 Q3886.2188,862.5313 3886.2188,863.8906 Q3886.2188,865.25 3886.6563,865.9375 Q3887.1094,866.625 3887.9688,866.625 Q3888.375,866.625 3888.75,866.4531 Q3889.1406,866.2813 3889.5625,865.8906 L3889.5625,867.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="3905.75" y="868.3911">featureMatching</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3785.5" x2="4102.5" y1="877.8906" y2="877.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="220" x="3790.5" y="892.1011">_params : featureMatchingParameters</text><line style="stroke: #444444; stroke-width: 1.0;" x1="3785.5" x2="4102.5" y1="898.6953" y2="898.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="307" x="3790.5" y="912.9058">+match(query, key) : (matches, nlfa, dissim, mu, var)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="3790.5" y="925.7104">+compute_delta(dissim) : (nlfa, mu, var)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="281" x="3790.5" y="938.5151">+compute_dissimilarities(queries, keys) : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="288" x="3790.5" y="951.3198">+match_subset(query, key, match_indices, deltas)</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="3785.5" x2="4102.5" y1="957.9141" y2="957.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="3790.5" y="972.1245">Metrics: CEMD (Circular Earth Mover's)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="3790.5" y="984.9292">L2 (Euclidean)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="164" x="3790.5" y="997.7339">NLFA = −log Φ(standardized)</text><!--MD5=[61f5d4b24f3162fe598ab1479aad49ae]
class featureMatchingParameters--><rect fill="#FEFEFE" height="117.9609" id="featureMatchingParameters" style="stroke: #444444; stroke-width: 1.5;" width="207" x="3784.5" y="1156.3906"/><ellipse cx="3797.5" cy="1175.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M3798.8125,1179.125 Q3798.4375,1179.3281 3798.0156,1179.4219 Q3797.6094,1179.5156 3797.1406,1179.5156 Q3795.5313,1179.5156 3794.6719,1178.4531 Q3793.8125,1177.375 3793.8125,1175.3594 Q3793.8125,1173.3281 3794.6719,1172.2656 Q3795.5313,1171.1875 3797.1406,1171.1875 Q3797.6094,1171.1875 3798.0156,1171.2969 Q3798.4375,1171.3906 3798.8125,1171.5781 L3798.8125,1173.3438 Q3798.3906,1172.9688 3798,1172.7969 Q3797.625,1172.625 3797.2188,1172.625 Q3796.3594,1172.625 3795.9063,1173.3125 Q3795.4688,1174 3795.4688,1175.3594 Q3795.4688,1176.7188 3795.9063,1177.4063 Q3796.3594,1178.0938 3797.2188,1178.0938 Q3797.625,1178.0938 3798,1177.9219 Q3798.3906,1177.75 3798.8125,1177.3594 L3798.8125,1179.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="3864.5" y="1171.6011">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="3809.5" y="1186.2622">featureMatchingParameters</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3785.5" x2="3990.5" y1="1194.3281" y2="1194.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="3790.5" y="1208.5386">metric : str = "CEMD"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="3790.5" y="1221.3433">epsilon : float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="3790.5" y="1234.1479">distribution : str = "normal"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="3790.5" y="1246.9526">partial_output : bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="3790.5" y="1259.7573">reciprocal_only : bool</text><line style="stroke: #444444; stroke-width: 1.5;" x1="3785.5" x2="3990.5" y1="1266.3516" y2="1266.3516"/><!--MD5=[6c4a1c24db9af003ae199c9e77e821fe]
class featureMatchingOutputs--><rect fill="#FEFEFE" height="117.9609" id="featureMatchingOutputs" style="stroke: #444444; stroke-width: 1.5;" width="183" x="4026.5" y="1156.3906"/><ellipse cx="4039.5" cy="1175.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4040.8125,1179.125 Q4040.4375,1179.3281 4040.0156,1179.4219 Q4039.6094,1179.5156 4039.1406,1179.5156 Q4037.5313,1179.5156 4036.6719,1178.4531 Q4035.8125,1177.375 4035.8125,1175.3594 Q4035.8125,1173.3281 4036.6719,1172.2656 Q4037.5313,1171.1875 4039.1406,1171.1875 Q4039.6094,1171.1875 4040.0156,1171.2969 Q4040.4375,1171.3906 4040.8125,1171.5781 L4040.8125,1173.3438 Q4040.3906,1172.9688 4040,1172.7969 Q4039.625,1172.625 4039.2188,1172.625 Q4038.3594,1172.625 4037.9063,1173.3125 Q4037.4688,1174 4037.4688,1175.3594 Q4037.4688,1176.7188 4037.9063,1177.4063 Q4038.3594,1178.0938 4039.2188,1178.0938 Q4039.625,1178.0938 4040,1177.9219 Q4040.3906,1177.75 4040.8125,1177.3594 L4040.8125,1179.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="4094.5" y="1171.6011">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="4051.5" y="1186.2622">featureMatchingOutputs</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4027.5" x2="4208.5" y1="1194.3281" y2="1194.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="4032.5" y="1208.5386">match_indices : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="4032.5" y="1221.3433">nlfa : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="4032.5" y="1234.1479">dissimilarities : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="4032.5" y="1246.9526">nlfa_threshold : float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="4032.5" y="1259.7573">nlfa2 : Tensor</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4027.5" x2="4208.5" y1="1266.3516" y2="1266.3516"/><!--MD5=[c0f1f7f6ddd402053cd61bb5d7299266]
class communityDetectionBase--><rect fill="#FEFEFE" height="56.8047" id="communityDetectionBase" style="stroke: #444444; stroke-width: 1.5;" width="206" x="6437" y="898.3906"/><ellipse cx="6455.4" cy="912.3906" fill="#A9DCDF" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6454.7125,909.3281 L6453.9625,912.6094 L6455.4625,912.6094 L6454.7125,909.3281 Z M6453.7438,907.875 L6455.6813,907.875 L6457.8531,915.8906 L6456.2594,915.8906 L6455.7594,913.9063 L6453.65,913.9063 L6453.1656,915.8906 L6451.5719,915.8906 L6453.7438,907.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="166" x="6468.6" y="916.8911">communityDetectionBase</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6438" x2="6642" y1="926.3906" y2="926.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="6438" x2="6642" y1="934.3906" y2="934.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="194" x="6443" y="948.6011">+__call__(G: Graph) : Membership</text><!--MD5=[639835832b30d2f5c67d436adcd5efbf]
class leidenCommunityDetection--><rect fill="#FEFEFE" height="69.6094" id="leidenCommunityDetection" style="stroke: #444444; stroke-width: 1.5;" width="202" x="6711" y="1180.3906"/><ellipse cx="6724" cy="1194.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6725.3125,1198.1563 Q6724.9375,1198.3594 6724.5156,1198.4531 Q6724.1094,1198.5469 6723.6406,1198.5469 Q6722.0313,1198.5469 6721.1719,1197.4844 Q6720.3125,1196.4063 6720.3125,1194.3906 Q6720.3125,1192.3594 6721.1719,1191.2969 Q6722.0313,1190.2188 6723.6406,1190.2188 Q6724.1094,1190.2188 6724.5156,1190.3281 Q6724.9375,1190.4219 6725.3125,1190.6094 L6725.3125,1192.375 Q6724.8906,1192 6724.5,1191.8281 Q6724.125,1191.6563 6723.7188,1191.6563 Q6722.8594,1191.6563 6722.4063,1192.3438 Q6721.9688,1193.0313 6721.9688,1194.3906 Q6721.9688,1195.75 6722.4063,1196.4375 Q6722.8594,1197.125 6723.7188,1197.125 Q6724.125,1197.125 6724.5,1196.9531 Q6724.8906,1196.7813 6725.3125,1196.3906 L6725.3125,1198.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="6736" y="1198.8911">leidenCommunityDetection</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6712" x2="6912" y1="1208.3906" y2="1208.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="6717" y="1222.6011">gamma : float</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6712" x2="6912" y1="1229.1953" y2="1229.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="151" x="6717" y="1243.4058">+__call__(G) : Membership</text><!--MD5=[39034dd6874431221e2cc5108f688d27]
class louvainCommunityDetection--><rect fill="#FEFEFE" height="56.8047" id="louvainCommunityDetection" style="stroke: #444444; stroke-width: 1.5;" width="209" x="6948.5" y="1186.8906"/><ellipse cx="6961.5" cy="1200.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6962.8125,1204.6563 Q6962.4375,1204.8594 6962.0156,1204.9531 Q6961.6094,1205.0469 6961.1406,1205.0469 Q6959.5313,1205.0469 6958.6719,1203.9844 Q6957.8125,1202.9063 6957.8125,1200.8906 Q6957.8125,1198.8594 6958.6719,1197.7969 Q6959.5313,1196.7188 6961.1406,1196.7188 Q6961.6094,1196.7188 6962.0156,1196.8281 Q6962.4375,1196.9219 6962.8125,1197.1094 L6962.8125,1198.875 Q6962.3906,1198.5 6962,1198.3281 Q6961.625,1198.1563 6961.2188,1198.1563 Q6960.3594,1198.1563 6959.9063,1198.8438 Q6959.4688,1199.5313 6959.4688,1200.8906 Q6959.4688,1202.25 6959.9063,1202.9375 Q6960.3594,1203.625 6961.2188,1203.625 Q6961.625,1203.625 6962,1203.4531 Q6962.3906,1203.2813 6962.8125,1202.8906 L6962.8125,1204.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="6973.5" y="1205.3911">louvainCommunityDetection</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6949.5" x2="7156.5" y1="1214.8906" y2="1214.8906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="6949.5" x2="7156.5" y1="1222.8906" y2="1222.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="151" x="6954.5" y="1237.1011">+__call__(G) : Membership</text><!--MD5=[96695e67b23870b72bc05764560c4790]
class greedyModularityCommunityDetection--><rect fill="#FEFEFE" height="44" id="greedyModularityCommunityDetection" style="stroke: #444444; stroke-width: 1.5;" width="274" x="6095" y="1193.3906"/><ellipse cx="6108" cy="1207.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6109.3125,1211.1563 Q6108.9375,1211.3594 6108.5156,1211.4531 Q6108.1094,1211.5469 6107.6406,1211.5469 Q6106.0313,1211.5469 6105.1719,1210.4844 Q6104.3125,1209.4063 6104.3125,1207.3906 Q6104.3125,1205.3594 6105.1719,1204.2969 Q6106.0313,1203.2188 6107.6406,1203.2188 Q6108.1094,1203.2188 6108.5156,1203.3281 Q6108.9375,1203.4219 6109.3125,1203.6094 L6109.3125,1205.375 Q6108.8906,1205 6108.5,1204.8281 Q6108.125,1204.6563 6107.7188,1204.6563 Q6106.8594,1204.6563 6106.4063,1205.3438 Q6105.9688,1206.0313 6105.9688,1207.3906 Q6105.9688,1208.75 6106.4063,1209.4375 Q6106.8594,1210.125 6107.7188,1210.125 Q6108.125,1210.125 6108.5,1209.9531 Q6108.8906,1209.7813 6109.3125,1209.3906 L6109.3125,1211.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="6120" y="1211.8911">greedyModularityCommunityDetection</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6096" x2="6368" y1="1221.3906" y2="1221.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="6096" x2="6368" y1="1229.3906" y2="1229.3906"/><!--MD5=[e37961857eb781206280c3da45bb3e28]
class labelPropagationCommunityDetection--><rect fill="#FEFEFE" height="44" id="labelPropagationCommunityDetection" style="stroke: #444444; stroke-width: 1.5;" width="271" x="6404.5" y="1193.3906"/><ellipse cx="6417.5" cy="1207.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6418.8125,1211.1563 Q6418.4375,1211.3594 6418.0156,1211.4531 Q6417.6094,1211.5469 6417.1406,1211.5469 Q6415.5313,1211.5469 6414.6719,1210.4844 Q6413.8125,1209.4063 6413.8125,1207.3906 Q6413.8125,1205.3594 6414.6719,1204.2969 Q6415.5313,1203.2188 6417.1406,1203.2188 Q6417.6094,1203.2188 6418.0156,1203.3281 Q6418.4375,1203.4219 6418.8125,1203.6094 L6418.8125,1205.375 Q6418.3906,1205 6418,1204.8281 Q6417.625,1204.6563 6417.2188,1204.6563 Q6416.3594,1204.6563 6415.9063,1205.3438 Q6415.4688,1206.0313 6415.4688,1207.3906 Q6415.4688,1208.75 6415.9063,1209.4375 Q6416.3594,1210.125 6417.2188,1210.125 Q6417.625,1210.125 6418,1209.9531 Q6418.3906,1209.7813 6418.8125,1209.3906 L6418.8125,1211.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="6429.5" y="1211.8911">labelPropagationCommunityDetection</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6405.5" x2="6674.5" y1="1221.3906" y2="1221.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="6405.5" x2="6674.5" y1="1229.3906" y2="1229.3906"/><!--MD5=[99b488e02ef3fdf238aa617178d39283]
class graphClustering--><rect fill="#FEFEFE" height="133.6328" id="graphClustering" style="stroke: #444444; stroke-width: 1.5;" width="283" x="6246.5" y="531.3906"/><ellipse cx="6333.75" cy="545.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6335.0625,549.1563 Q6334.6875,549.3594 6334.2656,549.4531 Q6333.8594,549.5469 6333.3906,549.5469 Q6331.7813,549.5469 6330.9219,548.4844 Q6330.0625,547.4063 6330.0625,545.3906 Q6330.0625,543.3594 6330.9219,542.2969 Q6331.7813,541.2188 6333.3906,541.2188 Q6333.8594,541.2188 6334.2656,541.3281 Q6334.6875,541.4219 6335.0625,541.6094 L6335.0625,543.375 Q6334.6406,543 6334.25,542.8281 Q6333.875,542.6563 6333.4688,542.6563 Q6332.6094,542.6563 6332.1563,543.3438 Q6331.7188,544.0313 6331.7188,545.3906 Q6331.7188,546.75 6332.1563,547.4375 Q6332.6094,548.125 6333.4688,548.125 Q6333.875,548.125 6334.25,547.9531 Q6334.6406,547.7813 6335.0625,547.3906 L6335.0625,549.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="6351.25" y="549.8911">graphClustering</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6247.5" x2="6528.5" y1="559.3906" y2="559.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="6252.5" y="573.6011">featureMatcher : featureMatching</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="271" x="6252.5" y="586.4058">communityDetection : communityDetectionBase</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="6252.5" y="599.2104">edges_type : str</text><line style="stroke: #444444; stroke-width: 1.0;" x1="6247.5" x2="6528.5" y1="605.8047" y2="605.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="6252.5" y="620.0151">+__call__(dataframe) : Membership</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6247.5" x2="6312" y1="633.0117" y2="633.0117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="6312" y="636.3198">builds NX graph from NLFA</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6464" x2="6528.5" y1="633.0117" y2="633.0117"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6247.5" x2="6314" y1="652.2188" y2="652.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="6314" y="655.5269">runs community detection</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6462" x2="6528.5" y1="652.2188" y2="652.2188"/><path d="M6678,883.3906 L6678,923.3906 L6643.02,927.3906 L6678,931.3906 L6678,970.2188 A0,0 0 0 0 6678,970.2188 L6914,970.2188 A0,0 0 0 0 6914,970.2188 L6914,893.3906 L6904,883.3906 L6678,883.3906 A0,0 0 0 0 6678,883.3906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M6904,883.3906 L6904,893.3906 L6914,893.3906 L6904,883.3906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="215" x="6684" y="898.6011">Wrapped distance-based alternatives:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="6684" y="911.4058">hdbscan(), dbscan(), optics(),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="199" x="6684" y="924.2104">affinity_propagation(), mean_shift()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="193" x="6684" y="937.0151">All use @sklearn_wrap decorator.</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="6684" y="949.8198">nlfa_to_distance() converts</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="6684" y="962.6245">NLFA similarity to metric space.</text><!--MD5=[7e1a7e3be50c2d1b88d130d670dd843d]
class graphClusteringSweep--><rect fill="#FEFEFE" height="300.4219" id="graphClusteringSweep" style="stroke: #444444; stroke-width: 1.5;" width="350" x="2868" y="448.3906"/><ellipse cx="2967.75" cy="467.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2969.0625,471.125 Q2968.6875,471.3281 2968.2656,471.4219 Q2967.8594,471.5156 2967.3906,471.5156 Q2965.7813,471.5156 2964.9219,470.4531 Q2964.0625,469.375 2964.0625,467.3594 Q2964.0625,465.3281 2964.9219,464.2656 Q2965.7813,463.1875 2967.3906,463.1875 Q2967.8594,463.1875 2968.2656,463.2969 Q2968.6875,463.3906 2969.0625,463.5781 L2969.0625,465.3438 Q2968.6406,464.9688 2968.25,464.7969 Q2967.875,464.625 2967.4688,464.625 Q2966.6094,464.625 2966.1563,465.3125 Q2965.7188,466 2965.7188,467.3594 Q2965.7188,468.7188 2966.1563,469.4063 Q2966.6094,470.0938 2967.4688,470.0938 Q2967.875,470.0938 2968.25,469.9219 Q2968.6406,469.75 2969.0625,469.3594 L2969.0625,471.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="117" x="2998.25" y="463.6011">«main orchestrator»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="2985.25" y="478.2622">graphClusteringSweep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2869" x2="3217" y1="486.3281" y2="486.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="2874" y="500.5386">featureMatcher : featureMatching</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="2874" y="513.3433">reporter : ClusteringSweepReporter</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="271" x="2874" y="526.1479">refinement_steps : List[ClusterRefinementStep]</text><line style="stroke: #444444; stroke-width: 1.0;" x1="2869" x2="3217" y1="532.7422" y2="532.7422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="338" x="2874" y="546.9526">+__call__(dataframe) : (df, filtered_df, reps_df, G, partition)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="315" x="2874" y="559.7573">+report_graph(df, nlfa, dissim, eps, gamma, renderer)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="288" x="2874" y="572.562">+get_graph(nlfa, dissim, epsilon) : (Graph, edges)</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="2869" x2="3217" y1="579.1563" y2="579.1563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="2874" y="593.3667">__call__ substeps:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="327" x="2874" y="606.1714">1. Sweep HOG configs (cell_size × bins × sigma × norm)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="267" x="2874" y="618.9761">2. Compute HOG features via Renderer + HOG</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="217" x="2874" y="631.7808">3. A contrario matching → NLFA matrix</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="2874" y="644.5854">4. Sweep ε × γ → Leiden partitions → best ARI</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="2874" y="657.3901">5. report_graph() with best config</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="2869" x2="3217" y1="663.9844" y2="663.9844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="2874" y="678.1948">report_graph substeps:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="2874" y="690.9995">1. Build NX graph + Leiden partition</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="2874" y="703.8042">2. Run refinement pipeline (steps)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="269" x="2874" y="716.6089">3. Post-clustering (CHAT split, hapax, glossary)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="2874" y="729.4136">4. Compute purity &amp; completeness</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="2874" y="742.2183">5. Delegate reporting</text><!--MD5=[d8fcc8ae0c8967188faf0e20bdcd3d6a]
class ClusteringSweepReporter--><rect fill="#FEFEFE" height="69.6094" id="ClusteringSweepReporter" style="stroke: #444444; stroke-width: 1.5;" width="267" x="2909.5" y="891.8906"/><ellipse cx="2958.75" cy="905.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2960.0625,909.6563 Q2959.6875,909.8594 2959.2656,909.9531 Q2958.8594,910.0469 2958.3906,910.0469 Q2956.7813,910.0469 2955.9219,908.9844 Q2955.0625,907.9063 2955.0625,905.8906 Q2955.0625,903.8594 2955.9219,902.7969 Q2956.7813,901.7188 2958.3906,901.7188 Q2958.8594,901.7188 2959.2656,901.8281 Q2959.6875,901.9219 2960.0625,902.1094 L2960.0625,903.875 Q2959.6406,903.5 2959.25,903.3281 Q2958.875,903.1563 2958.4688,903.1563 Q2957.6094,903.1563 2957.1563,903.8438 Q2956.7188,904.5313 2956.7188,905.8906 Q2956.7188,907.25 2957.1563,907.9375 Q2957.6094,908.625 2958.4688,908.625 Q2958.875,908.625 2959.25,908.4531 Q2959.6406,908.2813 2960.0625,907.8906 L2960.0625,909.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="2976.25" y="910.3911">ClusteringSweepReporter</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2910.5" x2="3175.5" y1="919.8906" y2="919.8906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="2910.5" x2="3175.5" y1="927.8906" y2="927.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="255" x="2915.5" y="942.1011">+report_hog_sweep(results_df, hog_configs)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="2915.5" y="954.9058">+report_graph_results(...)</text><!--MD5=[6022372239b8893c6168d7c4cb22f304]
class RefinementResult--><rect fill="#FEFEFE" height="92.3516" id="RefinementResult" style="stroke: #444444; stroke-width: 1.5;" width="140" x="4266" y="1169.3906"/><ellipse cx="4279" cy="1188.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4280.3125,1192.125 Q4279.9375,1192.3281 4279.5156,1192.4219 Q4279.1094,1192.5156 4278.6406,1192.5156 Q4277.0313,1192.5156 4276.1719,1191.4531 Q4275.3125,1190.375 4275.3125,1188.3594 Q4275.3125,1186.3281 4276.1719,1185.2656 Q4277.0313,1184.1875 4278.6406,1184.1875 Q4279.1094,1184.1875 4279.5156,1184.2969 Q4279.9375,1184.3906 4280.3125,1184.5781 L4280.3125,1186.3438 Q4279.8906,1185.9688 4279.5,1185.7969 Q4279.125,1185.625 4278.7188,1185.625 Q4277.8594,1185.625 4277.4063,1186.3125 Q4276.9688,1187 4276.9688,1188.3594 Q4276.9688,1189.7188 4277.4063,1190.4063 Q4277.8594,1191.0938 4278.7188,1191.0938 Q4279.125,1191.0938 4279.5,1190.9219 Q4279.8906,1190.75 4280.3125,1190.3594 L4280.3125,1192.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="4312.5" y="1184.6011">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="4291" y="1199.2622">RefinementResult</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4267" x2="4405" y1="1207.3281" y2="1207.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="4272" y="1221.5386">membership : ndarray</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="4272" y="1234.3433">log : List[Dict]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="4272" y="1247.1479">metadata : Dict</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4267" x2="4405" y1="1253.7422" y2="1253.7422"/><!--MD5=[b02abe806104833458125ba2d5c3183d]
class ClusterRefinementStep--><rect fill="#FEFEFE" height="69.6094" id="ClusterRefinementStep" style="stroke: #444444; stroke-width: 1.5;" width="419" x="4589.5" y="891.8906"/><ellipse cx="4721.25" cy="905.8906" fill="#A9DCDF" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4720.5625,902.8281 L4719.8125,906.1094 L4721.3125,906.1094 L4720.5625,902.8281 Z M4719.5938,901.375 L4721.5313,901.375 L4723.7031,909.3906 L4722.1094,909.3906 L4721.6094,907.4063 L4719.5,907.4063 L4719.0156,909.3906 L4717.4219,909.3906 L4719.5938,901.375 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="148" x="4738.75" y="910.3911">ClusterRefinementStep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4590.5" x2="5007.5" y1="919.8906" y2="919.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="4595.5" y="934.1011">name : str</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4590.5" x2="5007.5" y1="940.6953" y2="940.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="407" x="4595.5" y="954.9058">+run(df, membership, renderer, *, target_lbl, **ctx) : RefinementResult</text><!--MD5=[bd6f2ed3583eab214fa1848f99c76df8]
class HausdorffSplitStep--><rect fill="#FEFEFE" height="120.8281" id="HausdorffSplitStep" style="stroke: #444444; stroke-width: 1.5;" width="247" x="5445.5" y="1154.8906"/><ellipse cx="5505.25" cy="1168.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M5506.5625,1172.6563 Q5506.1875,1172.8594 5505.7656,1172.9531 Q5505.3594,1173.0469 5504.8906,1173.0469 Q5503.2813,1173.0469 5502.4219,1171.9844 Q5501.5625,1170.9063 5501.5625,1168.8906 Q5501.5625,1166.8594 5502.4219,1165.7969 Q5503.2813,1164.7188 5504.8906,1164.7188 Q5505.3594,1164.7188 5505.7656,1164.8281 Q5506.1875,1164.9219 5506.5625,1165.1094 L5506.5625,1166.875 Q5506.1406,1166.5 5505.75,1166.3281 Q5505.375,1166.1563 5504.9688,1166.1563 Q5504.1094,1166.1563 5503.6563,1166.8438 Q5503.2188,1167.5313 5503.2188,1168.8906 Q5503.2188,1170.25 5503.6563,1170.9375 Q5504.1094,1171.625 5504.9688,1171.625 Q5505.375,1171.625 5505.75,1171.4531 Q5506.1406,1171.2813 5506.5625,1170.8906 L5506.5625,1172.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="5522.75" y="1173.3911">HausdorffSplitStep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="5446.5" x2="5691.5" y1="1182.8906" y2="1182.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="5451.5" y="1197.1011">name = "hausdorff_split"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="5451.5" y="1209.9058">thresholds, linkage_method</text><line style="stroke: #444444; stroke-width: 1.0;" x1="5446.5" x2="5691.5" y1="1216.5" y2="1216.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="5451.5" y="1230.7104">Pairwise IC registration → Hausdorff</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="5451.5" y="1243.5151">distance → hierarchical linkage → fcluster</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="214" x="5451.5" y="1256.3198">Unknown-label patches reassigned to</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="5451.5" y="1269.1245">largest sub-cluster.</text><!--MD5=[3ff8d3e97210455ecca045db94ba4cda]
class OCRRematchStep--><rect fill="#FEFEFE" height="95.2188" id="OCRRematchStep" style="stroke: #444444; stroke-width: 1.5;" width="234" x="4682" y="1167.8906"/><ellipse cx="4738.25" cy="1181.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4739.5625,1185.6563 Q4739.1875,1185.8594 4738.7656,1185.9531 Q4738.3594,1186.0469 4737.8906,1186.0469 Q4736.2813,1186.0469 4735.4219,1184.9844 Q4734.5625,1183.9063 4734.5625,1181.8906 Q4734.5625,1179.8594 4735.4219,1178.7969 Q4736.2813,1177.7188 4737.8906,1177.7188 Q4738.3594,1177.7188 4738.7656,1177.8281 Q4739.1875,1177.9219 4739.5625,1178.1094 L4739.5625,1179.875 Q4739.1406,1179.5 4738.75,1179.3281 Q4738.375,1179.1563 4737.9688,1179.1563 Q4737.1094,1179.1563 4736.6563,1179.8438 Q4736.2188,1180.5313 4736.2188,1181.8906 Q4736.2188,1183.25 4736.6563,1183.9375 Q4737.1094,1184.625 4737.9688,1184.625 Q4738.375,1184.625 4738.75,1184.4531 Q4739.1406,1184.2813 4739.5625,1183.8906 L4739.5625,1185.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="4755.75" y="1186.3911">OCRRematchStep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4683" x2="4915" y1="1195.8906" y2="1195.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="4688" y="1210.1011">name = "ocr_rematch"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="4688" y="1222.9058">max_cluster_size : int</text><line style="stroke: #444444; stroke-width: 1.0;" x1="4683" x2="4915" y1="1229.5" y2="1229.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="4688" y="1243.7104">Merge small clusters into largest</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="4688" y="1256.5151">cluster with same dominant OCR label.</text><!--MD5=[d8d88411b491b6957effbf7cf27c5d00]
class PCAZScoreRematchStep--><rect fill="#FEFEFE" height="108.0234" id="PCAZScoreRematchStep" style="stroke: #444444; stroke-width: 1.5;" width="221" x="5189.5" y="1161.3906"/><ellipse cx="5217.35" cy="1175.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M5218.6625,1179.1563 Q5218.2875,1179.3594 5217.8656,1179.4531 Q5217.4594,1179.5469 5216.9906,1179.5469 Q5215.3813,1179.5469 5214.5219,1178.4844 Q5213.6625,1177.4063 5213.6625,1175.3906 Q5213.6625,1173.3594 5214.5219,1172.2969 Q5215.3813,1171.2188 5216.9906,1171.2188 Q5217.4594,1171.2188 5217.8656,1171.3281 Q5218.2875,1171.4219 5218.6625,1171.6094 L5218.6625,1173.375 Q5218.2406,1173 5217.85,1172.8281 Q5217.475,1172.6563 5217.0688,1172.6563 Q5216.2094,1172.6563 5215.7563,1173.3438 Q5215.3188,1174.0313 5215.3188,1175.3906 Q5215.3188,1176.75 5215.7563,1177.4375 Q5216.2094,1178.125 5217.0688,1178.125 Q5217.475,1178.125 5217.85,1177.9531 Q5218.2406,1177.7813 5218.6625,1177.3906 L5218.6625,1179.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="5232.65" y="1179.8911">PCAZScoreRematchStep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="5190.5" x2="5409.5" y1="1189.3906" y2="1189.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="175" x="5195.5" y="1203.6011">name = "pca_zscore_rematch"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="5195.5" y="1216.4058">pca_k, z_max, n_candidates</text><line style="stroke: #444444; stroke-width: 1.0;" x1="5190.5" x2="5409.5" y1="1223" y2="1223"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="209" x="5195.5" y="1237.2104">Register query onto anchor → PCA of</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="183" x="5195.5" y="1250.0151">target → z-score test → merge if</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="5195.5" y="1262.8198">max|z| &lt; z_max.</text><!--MD5=[69d3bbbb0c80a7e056ba9f87333e4408]
class MRFRefinementStep--><rect fill="#FEFEFE" height="120.8281" id="MRFRefinementStep" style="stroke: #444444; stroke-width: 1.5;" width="205" x="4441.5" y="1154.8906"/><ellipse cx="4476.1" cy="1168.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4477.4125,1172.6563 Q4477.0375,1172.8594 4476.6156,1172.9531 Q4476.2094,1173.0469 4475.7406,1173.0469 Q4474.1313,1173.0469 4473.2719,1171.9844 Q4472.4125,1170.9063 4472.4125,1168.8906 Q4472.4125,1166.8594 4473.2719,1165.7969 Q4474.1313,1164.7188 4475.7406,1164.7188 Q4476.2094,1164.7188 4476.6156,1164.8281 Q4477.0375,1164.9219 4477.4125,1165.1094 L4477.4125,1166.875 Q4476.9906,1166.5 4476.6,1166.3281 Q4476.225,1166.1563 4475.8188,1166.1563 Q4474.9594,1166.1563 4474.5063,1166.8438 Q4474.0688,1167.5313 4474.0688,1168.8906 Q4474.0688,1170.25 4474.5063,1170.9375 Q4474.9594,1171.625 4475.8188,1171.625 Q4476.225,1171.625 4476.6,1171.4531 Q4476.9906,1171.2813 4477.4125,1170.8906 L4477.4125,1172.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="4492.9" y="1173.3911">MRFRefinementStep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4442.5" x2="4645.5" y1="1182.8906" y2="1182.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="4447.5" y="1197.1011">name = "mrf_bp"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="154" x="4447.5" y="1209.9058">mrf : MRFBeliefPropagation</text><line style="stroke: #444444; stroke-width: 1.0;" x1="4442.5" x2="4645.5" y1="1216.5" y2="1216.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="4447.5" y="1230.7104">Unary: OCR probabilities</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="193" x="4447.5" y="1243.5151">Pairwise: generalized Potts (NLFA)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="4447.5" y="1256.3198">Inference: max-sum loopy BP</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="4447.5" y="1269.1245">Requires nlfa in ctx.</text><!--MD5=[0352b1a2bd5ba60a188aa90bc06ea00c]
class KMedoidsSplitMergeStep--><rect fill="#FEFEFE" height="108.0234" id="KMedoidsSplitMergeStep" style="stroke: #444444; stroke-width: 1.5;" width="203" x="4951.5" y="1161.3906"/><ellipse cx="4971.7" cy="1175.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4973.0125,1179.1563 Q4972.6375,1179.3594 4972.2156,1179.4531 Q4971.8094,1179.5469 4971.3406,1179.5469 Q4969.7313,1179.5469 4968.8719,1178.4844 Q4968.0125,1177.4063 4968.0125,1175.3906 Q4968.0125,1173.3594 4968.8719,1172.2969 Q4969.7313,1171.2188 4971.3406,1171.2188 Q4971.8094,1171.2188 4972.2156,1171.3281 Q4972.6375,1171.4219 4973.0125,1171.6094 L4973.0125,1173.375 Q4972.5906,1173 4972.2,1172.8281 Q4971.825,1172.6563 4971.4188,1172.6563 Q4970.5594,1172.6563 4970.1063,1173.3438 Q4969.6688,1174.0313 4969.6688,1175.3906 Q4969.6688,1176.75 4970.1063,1177.4375 Q4970.5594,1178.125 4971.4188,1178.125 Q4971.825,1178.125 4972.2,1177.9531 Q4972.5906,1177.7813 4973.0125,1177.3906 L4973.0125,1179.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="4985.3" y="1179.8911">KMedoidsSplitMergeStep</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4952.5" x2="5153.5" y1="1189.3906" y2="1189.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="187" x="4957.5" y="1203.6011">name = "kmedoids_split_merge"</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="181" x="4957.5" y="1216.4058">kmedoids : KMedoidsSplitMerge</text><line style="stroke: #444444; stroke-width: 1.0;" x1="4952.5" x2="5153.5" y1="1223" y2="1223"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="4957.5" y="1237.2104">reassign → spectral split (Fiedler)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="4957.5" y="1250.0151">→ NFA-validated merge</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="4957.5" y="1262.8198">Requires nlfa in ctx.</text><!--MD5=[454fc9b4e1a2dd1ffea6ac68a595d5d7]
class MRFBeliefPropagation--><rect fill="#FEFEFE" height="127.2305" id="MRFBeliefPropagation" style="stroke: #444444; stroke-width: 1.5;" width="266" x="4582" y="1444.8906"/><ellipse cx="4642.25" cy="1458.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4643.5625,1462.6563 Q4643.1875,1462.8594 4642.7656,1462.9531 Q4642.3594,1463.0469 4641.8906,1463.0469 Q4640.2813,1463.0469 4639.4219,1461.9844 Q4638.5625,1460.9063 4638.5625,1458.8906 Q4638.5625,1456.8594 4639.4219,1455.7969 Q4640.2813,1454.7188 4641.8906,1454.7188 Q4642.3594,1454.7188 4642.7656,1454.8281 Q4643.1875,1454.9219 4643.5625,1455.1094 L4643.5625,1456.875 Q4643.1406,1456.5 4642.75,1456.3281 Q4642.375,1456.1563 4641.9688,1456.1563 Q4641.1094,1456.1563 4640.6563,1456.8438 Q4640.2188,1457.5313 4640.2188,1458.8906 Q4640.2188,1460.25 4640.6563,1460.9375 Q4641.1094,1461.625 4641.9688,1461.625 Q4642.375,1461.625 4642.75,1461.4531 Q4643.1406,1461.2813 4643.5625,1460.8906 L4643.5625,1462.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="4659.75" y="1463.3911">MRFBeliefPropagation</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4583" x2="4847" y1="1472.8906" y2="1472.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="4588" y="1487.1011">beta, max_iter, damping</text><line style="stroke: #444444; stroke-width: 1.0;" x1="4583" x2="4847" y1="1493.6953" y2="1493.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="254" x="4588" y="1507.9058">+fit(nlfa, edges, ocr_probs, init_labels) : dict</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4583" x2="4662" y1="1520.9023" y2="1520.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="4662" y="1524.2104">max-sum loopy BP</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4768" x2="4847" y1="1520.9023" y2="1520.9023"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4583" x2="4639" y1="1540.1094" y2="1540.1094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="4639" y="1543.4175">damped message passing</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4791" x2="4847" y1="1540.1094" y2="1540.1094"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4583" x2="4621.5" y1="1559.3164" y2="1559.3164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="187" x="4621.5" y="1562.6245">converges on stable assignment</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4808.5" x2="4847" y1="1559.3164" y2="1559.3164"/><!--MD5=[7712a15c8fade74f03f86959b955c757]
class KMedoidsSplitMerge--><rect fill="#FEFEFE" height="172.0469" id="KMedoidsSplitMerge" style="stroke: #444444; stroke-width: 1.5;" width="223" x="4883.5" y="1422.3906"/><ellipse cx="4926.75" cy="1436.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M4928.0625,1440.1563 Q4927.6875,1440.3594 4927.2656,1440.4531 Q4926.8594,1440.5469 4926.3906,1440.5469 Q4924.7813,1440.5469 4923.9219,1439.4844 Q4923.0625,1438.4063 4923.0625,1436.3906 Q4923.0625,1434.3594 4923.9219,1433.2969 Q4924.7813,1432.2188 4926.3906,1432.2188 Q4926.8594,1432.2188 4927.2656,1432.3281 Q4927.6875,1432.4219 4928.0625,1432.6094 L4928.0625,1434.375 Q4927.6406,1434 4927.25,1433.8281 Q4926.875,1433.6563 4926.4688,1433.6563 Q4925.6094,1433.6563 4925.1563,1434.3438 Q4924.7188,1435.0313 4924.7188,1436.3906 Q4924.7188,1437.75 4925.1563,1438.4375 Q4925.6094,1439.125 4926.4688,1439.125 Q4926.875,1439.125 4927.25,1438.9531 Q4927.6406,1438.7813 4928.0625,1438.3906 L4928.0625,1440.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="4944.25" y="1440.8911">KMedoidsSplitMerge</text><line style="stroke: #444444; stroke-width: 1.5;" x1="4884.5" x2="5105.5" y1="1450.3906" y2="1450.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="182" x="4889.5" y="1464.6011">max_iter, split_threshold_sigma</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="4889.5" y="1477.4058">min_split_size, merge_nlfa_threshold</text><line style="stroke: #444444; stroke-width: 1.0;" x1="4884.5" x2="5105.5" y1="1484" y2="1484"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="4889.5" y="1498.2104">+fit(init_labels, nlfa, D) : dict</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="4889.5" y="1511.0151">-_medoids(labels, D) : dict</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="4889.5" y="1523.8198">-_reassign(labels, D, medoids) : int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="209" x="4889.5" y="1536.6245">-_split(labels, D, nlfa, threshold) : int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="4889.5" y="1549.4292">-_merge(labels, nlfa, medoids) : int</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4884.5" x2="4904" y1="1562.4258" y2="1562.4258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="182" x="4904" y="1565.7339">Fiedler vector spectral bisection</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="5086" x2="5105.5" y1="1562.4258" y2="1562.4258"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="4884.5" x2="4897.5" y1="1581.6328" y2="1581.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="4897.5" y="1584.9409">NFA-validated cross-edge merging</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="5092.5" x2="5105.5" y1="1581.6328" y2="1581.6328"/><!--MD5=[fd03a57df3036131272b218ab40b835b]
class post_mod--><rect fill="#FEFEFE" height="120.8281" id="post_mod" style="stroke: #444444; stroke-width: 1.5;" width="291" x="5748.5" y="866.3906"/><ellipse cx="5844.25" cy="880.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M5845.5625,884.1563 Q5845.1875,884.3594 5844.7656,884.4531 Q5844.3594,884.5469 5843.8906,884.5469 Q5842.2813,884.5469 5841.4219,883.4844 Q5840.5625,882.4063 5840.5625,880.3906 Q5840.5625,878.3594 5841.4219,877.2969 Q5842.2813,876.2188 5843.8906,876.2188 Q5844.3594,876.2188 5844.7656,876.3281 Q5845.1875,876.4219 5845.5625,876.6094 L5845.5625,878.375 Q5845.1406,878 5844.75,877.8281 Q5844.375,877.6563 5843.9688,877.6563 Q5843.1094,877.6563 5842.6563,878.3438 Q5842.2188,879.0313 5842.2188,880.3906 Q5842.2188,881.75 5842.6563,882.4375 Q5843.1094,883.125 5843.9688,883.125 Q5844.375,883.125 5844.75,882.9531 Q5845.1406,882.7813 5845.5625,882.3906 L5845.5625,884.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="5861.75" y="884.8911">&lt;&lt;module&gt;&gt;</text><line style="stroke: #444444; stroke-width: 1.5;" x1="5749.5" x2="6038.5" y1="894.3906" y2="894.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="256" x="5754.5" y="908.6011">+chat_split_clusters(df, dissim, ...) : (df, log)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="5754.5" y="921.4058">+associate_hapax(df, dissim, ...) : (df, log)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="5754.5" y="934.2104">+build_glossary(df, target_lbl) : DataFrame</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="5749.5" x2="6038.5" y1="940.8047" y2="940.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="279" x="5754.5" y="955.0151">CHAT-based split: impure clusters → subclusters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="275" x="5754.5" y="967.8198">Hapax association: singletons → nearest cluster</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="5754.5" y="980.6245">Glossary: character inventory sorted by count</text><!--MD5=[6ab62d51f073ced924755ebd8ee65b99]
class Transformation--><rect fill="#FEFEFE" height="120.8281" id="Transformation" style="stroke: #444444; stroke-width: 1.5;" width="246" x="6681" y="1692.8906"/><ellipse cx="6751.75" cy="1706.8906" fill="#A9DCDF" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6751.0625,1703.8281 L6750.3125,1707.1094 L6751.8125,1707.1094 L6751.0625,1703.8281 Z M6750.0938,1702.375 L6752.0313,1702.375 L6754.2031,1710.3906 L6752.6094,1710.3906 L6752.1094,1708.4063 L6750,1708.4063 L6749.5156,1710.3906 L6747.9219,1710.3906 L6750.0938,1702.375 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="97" x="6769.25" y="1711.3911">Transformation</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6682" x2="6926" y1="1720.8906" y2="1720.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="125" x="6687" y="1735.1011">+inv : Transformation</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6682" x2="6926" y1="1741.6953" y2="1741.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="6687" y="1755.9058">+jacobian(xx, yy)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="234" x="6687" y="1768.7104">+warp(img_batch, mode, padding_mode)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="199" x="6687" y="1781.5151">+compose(other) : Transformation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="6687" y="1794.3198">+visibility_mask(H, W, delta)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="6687" y="1807.1245">+__matmul__(other)</text><!--MD5=[5140467f568835acd444f840b470a03d]
class PlanarTransform--><rect fill="#FEFEFE" height="146.4375" id="PlanarTransform" style="stroke: #444444; stroke-width: 1.5;" width="385" x="6541.5" y="1910.3906"/><ellipse cx="6677.75" cy="1924.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6679.0625,1928.1563 Q6678.6875,1928.3594 6678.2656,1928.4531 Q6677.8594,1928.5469 6677.3906,1928.5469 Q6675.7813,1928.5469 6674.9219,1927.4844 Q6674.0625,1926.4063 6674.0625,1924.3906 Q6674.0625,1922.3594 6674.9219,1921.2969 Q6675.7813,1920.2188 6677.3906,1920.2188 Q6677.8594,1920.2188 6678.2656,1920.3281 Q6678.6875,1920.4219 6679.0625,1920.6094 L6679.0625,1922.375 Q6678.6406,1922 6678.25,1921.8281 Q6677.875,1921.6563 6677.4688,1921.6563 Q6676.6094,1921.6563 6676.1563,1922.3438 Q6675.7188,1923.0313 6675.7188,1924.3906 Q6675.7188,1925.75 6676.1563,1926.4375 Q6676.6094,1927.125 6677.4688,1927.125 Q6677.875,1927.125 6678.25,1926.9531 Q6678.6406,1926.7813 6679.0625,1926.3906 L6679.0625,1928.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="6695.25" y="1928.8911">PlanarTransform</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6542.5" x2="6925.5" y1="1938.3906" y2="1938.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="373" x="6547.5" y="1952.6011">transform_type : str  «translation|euclidean|affinity|homography»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="6547.5" y="1965.4058">matrix : Tensor (B, 3, 3)</text><line style="stroke: #444444; stroke-width: 1.0;" x1="6542.5" x2="6925.5" y1="1972" y2="1972"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="155" x="6547.5" y="1986.2104">+warp(img_batch) : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="6547.5" y="1999.0151">+inv : PlanarTransform</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="207" x="6547.5" y="2011.8198">+compose(other) : PlanarTransform</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="188" x="6547.5" y="2024.6245">+scale(factor) : PlanarTransform</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="6547.5" y="2037.4292">+jacobian(xx, yy) : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="6547.5" y="2050.2339">+visibility_mask(H, W, delta) : Tensor</text><!--MD5=[d5e7132936f58484fac936d8926c4853]
class InverseCompositional--><rect fill="#FEFEFE" height="165.6445" id="InverseCompositional" style="stroke: #444444; stroke-width: 1.5;" width="344" x="6065" y="1670.3906"/><ellipse cx="6164.75" cy="1684.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6166.0625,1688.1563 Q6165.6875,1688.3594 6165.2656,1688.4531 Q6164.8594,1688.5469 6164.3906,1688.5469 Q6162.7813,1688.5469 6161.9219,1687.4844 Q6161.0625,1686.4063 6161.0625,1684.3906 Q6161.0625,1682.3594 6161.9219,1681.2969 Q6162.7813,1680.2188 6164.3906,1680.2188 Q6164.8594,1680.2188 6165.2656,1680.3281 Q6165.6875,1680.4219 6166.0625,1680.6094 L6166.0625,1682.375 Q6165.6406,1682 6165.25,1681.8281 Q6164.875,1681.6563 6164.4688,1681.6563 Q6163.6094,1681.6563 6163.1563,1682.3438 Q6162.7188,1683.0313 6162.7188,1684.3906 Q6162.7188,1685.75 6163.1563,1686.4375 Q6163.6094,1687.125 6164.4688,1687.125 Q6164.875,1687.125 6165.25,1686.9531 Q6165.6406,1686.7813 6166.0625,1686.3906 L6166.0625,1688.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="6182.25" y="1688.8911">InverseCompositional</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6066" x2="6408" y1="1698.3906" y2="1698.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="115" x="6071" y="1712.6011">transform_type : str</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="164" x="6071" y="1725.4058">gradient_method : Gradients</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="332" x="6071" y="1738.2104">error_function : str «lorentzian|geman_mcclure|quadratic»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="6071" y="1751.0151">max_iter, epsilon</text><line style="stroke: #444444; stroke-width: 1.0;" x1="6066" x2="6408" y1="1757.6094" y2="1757.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="6071" y="1771.8198">+run(I1, I2, p_init) : PlanarTransform</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6066" x2="6161.5" y1="1784.8164" y2="1784.8164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="151" x="6161.5" y="1788.1245">Gauss-Newton on Hessian</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6312.5" x2="6408" y1="1784.8164" y2="1784.8164"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6066" x2="6174" y1="1804.0234" y2="1804.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="6174" y="1807.3315">robust error functions</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6300" x2="6408" y1="1804.0234" y2="1804.0234"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6066" x2="6174.5" y1="1823.2305" y2="1823.2305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="6174.5" y="1826.5386">fully batched (B pairs)</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6299.5" x2="6408" y1="1823.2305" y2="1823.2305"/><!--MD5=[4286a57bd045e36c37f04d7cc96749f2]
class GaussianPyramid--><rect fill="#FEFEFE" height="88.8164" id="GaussianPyramid" style="stroke: #444444; stroke-width: 1.5;" width="202" x="6444" y="1708.8906"/><ellipse cx="6485.75" cy="1722.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6487.0625,1726.6563 Q6486.6875,1726.8594 6486.2656,1726.9531 Q6485.8594,1727.0469 6485.3906,1727.0469 Q6483.7813,1727.0469 6482.9219,1725.9844 Q6482.0625,1724.9063 6482.0625,1722.8906 Q6482.0625,1720.8594 6482.9219,1719.7969 Q6483.7813,1718.7188 6485.3906,1718.7188 Q6485.8594,1718.7188 6486.2656,1718.8281 Q6486.6875,1718.9219 6487.0625,1719.1094 L6487.0625,1720.875 Q6486.6406,1720.5 6486.25,1720.3281 Q6485.875,1720.1563 6485.4688,1720.1563 Q6484.6094,1720.1563 6484.1563,1720.8438 Q6483.7188,1721.5313 6483.7188,1722.8906 Q6483.7188,1724.25 6484.1563,1724.9375 Q6484.6094,1725.625 6485.4688,1725.625 Q6485.875,1725.625 6486.25,1725.4531 Q6486.6406,1725.2813 6487.0625,1724.8906 L6487.0625,1726.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="6503.25" y="1727.3911">GaussianPyramid</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6445" x2="6645" y1="1736.8906" y2="1736.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="6450" y="1751.1011">eta, sigma_0, N_scales, min_size</text><line style="stroke: #444444; stroke-width: 1.0;" x1="6445" x2="6645" y1="1757.6953" y2="1757.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="6450" y="1771.9058">+__call__(img) : List[Tensor]</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6445" x2="6469" y1="1784.9023" y2="1784.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="6469" y="1788.2104">coarse-to-fine image stack</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6621" x2="6645" y1="1784.9023" y2="1784.9023"/><!--MD5=[6ec9e4ae6719e5bf91a0d55070509d6a]
class MultiscaleIC--><rect fill="#FEFEFE" height="114.4258" id="MultiscaleIC" style="stroke: #444444; stroke-width: 1.5;" width="222" x="6126" y="1451.3906"/><ellipse cx="6195.75" cy="1465.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6197.0625,1469.1563 Q6196.6875,1469.3594 6196.2656,1469.4531 Q6195.8594,1469.5469 6195.3906,1469.5469 Q6193.7813,1469.5469 6192.9219,1468.4844 Q6192.0625,1467.4063 6192.0625,1465.3906 Q6192.0625,1463.3594 6192.9219,1462.2969 Q6193.7813,1461.2188 6195.3906,1461.2188 Q6195.8594,1461.2188 6196.2656,1461.3281 Q6196.6875,1461.4219 6197.0625,1461.6094 L6197.0625,1463.375 Q6196.6406,1463 6196.25,1462.8281 Q6195.875,1462.6563 6195.4688,1462.6563 Q6194.6094,1462.6563 6194.1563,1463.3438 Q6193.7188,1464.0313 6193.7188,1465.3906 Q6193.7188,1466.75 6194.1563,1467.4375 Q6194.6094,1468.125 6195.4688,1468.125 Q6195.875,1468.125 6196.25,1467.9531 Q6196.6406,1467.7813 6197.0625,1467.3906 L6197.0625,1469.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="6213.25" y="1469.8911">MultiscaleIC</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6127" x2="6347" y1="1479.3906" y2="1479.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="6132" y="1493.6011">ic : InverseCompositional</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="6132" y="1506.4058">pyramid : GaussianPyramid</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="6132" y="1519.2104">first_scale : int</text><line style="stroke: #444444; stroke-width: 1.0;" x1="6127" x2="6347" y1="1525.8047" y2="1525.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="6132" y="1540.0151">+run(I1, I2, p_init) : PlanarTransform</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6127" x2="6161" y1="1553.0117" y2="1553.0117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="6161" y="1556.3198">coarse → fine IC alignment</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6313" x2="6347" y1="1553.0117" y2="1553.0117"/><!--MD5=[746167c6bcb43aa7d854e297c477be2d]
class Gradients--><rect fill="#FEFEFE" height="120.8281" id="Gradients" style="stroke: #444444; stroke-width: 1.5;" width="188" x="6143" y="1922.8906"/><ellipse cx="6202.25" cy="1936.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M6203.5625,1940.6563 Q6203.1875,1940.8594 6202.7656,1940.9531 Q6202.3594,1941.0469 6201.8906,1941.0469 Q6200.2813,1941.0469 6199.4219,1939.9844 Q6198.5625,1938.9063 6198.5625,1936.8906 Q6198.5625,1934.8594 6199.4219,1933.7969 Q6200.2813,1932.7188 6201.8906,1932.7188 Q6202.3594,1932.7188 6202.7656,1932.8281 Q6203.1875,1932.9219 6203.5625,1933.1094 L6203.5625,1934.875 Q6203.1406,1934.5 6202.75,1934.3281 Q6202.375,1934.1563 6201.9688,1934.1563 Q6201.1094,1934.1563 6200.6563,1934.8438 Q6200.2188,1935.5313 6200.2188,1936.8906 Q6200.2188,1938.25 6200.6563,1938.9375 Q6201.1094,1939.625 6201.9688,1939.625 Q6202.375,1939.625 6202.75,1939.4531 Q6203.1406,1939.2813 6203.5625,1938.8906 L6203.5625,1940.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="6219.75" y="1941.3911">Gradients</text><line style="stroke: #444444; stroke-width: 1.5;" x1="6144" x2="6330" y1="1950.8906" y2="1950.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="6149" y="1965.1011">method : str</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="34" x="6149" y="1977.9058">C : int</text><line style="stroke: #444444; stroke-width: 1.0;" x1="6144" x2="6330" y1="1984.5" y2="1984.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="6149" y="1998.7104">+__call__(image) : (Ix, Iy)</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6144" x2="6174.5" y1="2011.707" y2="2011.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="6174.5" y="2015.0151">separable convolution</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6299.5" x2="6330" y1="2011.707" y2="2011.707"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6144" x2="6147" y1="2030.9141" y2="2030.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="6147" y="2034.2222">supports: central, farid3, farid5</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="6327" x2="6330" y1="2030.9141" y2="2030.9141"/><!--MD5=[8125cf7b9e7a54321402ebeefb1a9ee9]
class align_utils--><rect fill="#FEFEFE" height="95.2188" id="align_utils" style="stroke: #444444; stroke-width: 1.5;" width="334" x="7214" y="1167.8906"/><ellipse cx="7280.75" cy="1181.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7282.0625,1185.6563 Q7281.6875,1185.8594 7281.2656,1185.9531 Q7280.8594,1186.0469 7280.3906,1186.0469 Q7278.7813,1186.0469 7277.9219,1184.9844 Q7277.0625,1183.9063 7277.0625,1181.8906 Q7277.0625,1179.8594 7277.9219,1178.7969 Q7278.7813,1177.7188 7280.3906,1177.7188 Q7280.8594,1177.7188 7281.2656,1177.8281 Q7281.6875,1177.9219 7282.0625,1178.1094 L7282.0625,1179.875 Q7281.6406,1179.5 7281.25,1179.3281 Q7280.875,1179.1563 7280.4688,1179.1563 Q7279.6094,1179.1563 7279.1563,1179.8438 Q7278.7188,1180.5313 7278.7188,1181.8906 Q7278.7188,1183.25 7279.1563,1183.9375 Q7279.6094,1184.625 7280.4688,1184.625 Q7280.875,1184.625 7281.25,1184.4531 Q7281.6406,1184.2813 7282.0625,1183.8906 L7282.0625,1185.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="7298.25" y="1186.3911">&lt;&lt;module&gt;&gt; alignment_utils</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7215" x2="7547" y1="1195.8906" y2="1195.8906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="7215" x2="7547" y1="1203.8906" y2="1203.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="258" x="7220" y="1218.1011">+create_default_aligner(device) : MultiscaleIC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="7220" y="1230.9058">+pairwise_align(aligner, I1, I2) : (PlanarTransform, float)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="238" x="7220" y="1243.7104">+warp_image(image, transform) : Tensor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="7220" y="1256.5151">+median_template(aligned) : Tensor</text><!--MD5=[9f748f55c127f9afb30a3fb68a4a0712]
class MSTAlignment--><rect fill="#FEFEFE" height="167.2422" id="MSTAlignment" style="stroke: #444444; stroke-width: 1.5;" width="314" x="7505" y="843.3906"/><ellipse cx="7612.25" cy="857.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7613.5625,861.1563 Q7613.1875,861.3594 7612.7656,861.4531 Q7612.3594,861.5469 7611.8906,861.5469 Q7610.2813,861.5469 7609.4219,860.4844 Q7608.5625,859.4063 7608.5625,857.3906 Q7608.5625,855.3594 7609.4219,854.2969 Q7610.2813,853.2188 7611.8906,853.2188 Q7612.3594,853.2188 7612.7656,853.3281 Q7613.1875,853.4219 7613.5625,853.6094 L7613.5625,855.375 Q7613.1406,855 7612.75,854.8281 Q7612.375,854.6563 7611.9688,854.6563 Q7611.1094,854.6563 7610.6563,855.3438 Q7610.2188,856.0313 7610.2188,857.3906 Q7610.2188,858.75 7610.6563,859.4375 Q7611.1094,860.125 7611.9688,860.125 Q7612.375,860.125 7612.75,859.9531 Q7613.1406,859.7813 7613.5625,859.3906 L7613.5625,861.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="7629.75" y="861.8911">MSTAlignment</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7506" x2="7818" y1="871.3906" y2="871.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="7511" y="885.6011">k_neighbors, n_refinement_rounds</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="7511" y="898.4058">aligner : MultiscaleIC</text><line style="stroke: #444444; stroke-width: 1.0;" x1="7506" x2="7818" y1="905" y2="905"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="302" x="7511" y="919.2104">+align_cluster(images, nlfa_sub, distance_sub) : dict</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7506" x2="7818" y1="925.8047" y2="925.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="7511" y="940.0151">1. Select medoid (min total distance)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="7511" y="952.8198">2. k-NN edge set from NLFA</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="135" x="7511" y="965.6245">3. Pairwise IC residuals</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="7511" y="978.4292">4. Scipy MST construction</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="228" x="7511" y="991.2339">5. BFS transform propagation from root</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="232" x="7511" y="1004.0386">6. Median template + refinement rounds</text><!--MD5=[2b47a727f43b1c051aa5740a0a1a260f]
class Congealing--><rect fill="#FEFEFE" height="141.6328" id="Congealing" style="stroke: #444444; stroke-width: 1.5;" width="256" x="7214" y="855.8906"/><ellipse cx="7302.75" cy="869.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7304.0625,873.6563 Q7303.6875,873.8594 7303.2656,873.9531 Q7302.8594,874.0469 7302.3906,874.0469 Q7300.7813,874.0469 7299.9219,872.9844 Q7299.0625,871.9063 7299.0625,869.8906 Q7299.0625,867.8594 7299.9219,866.7969 Q7300.7813,865.7188 7302.3906,865.7188 Q7302.8594,865.7188 7303.2656,865.8281 Q7303.6875,865.9219 7304.0625,866.1094 L7304.0625,867.875 Q7303.6406,867.5 7303.25,867.3281 Q7302.875,867.1563 7302.4688,867.1563 Q7301.6094,867.1563 7301.1563,867.8438 Q7300.7188,868.5313 7300.7188,869.8906 Q7300.7188,871.25 7301.1563,871.9375 Q7301.6094,872.625 7302.4688,872.625 Q7302.875,872.625 7303.25,872.4531 Q7303.6406,872.2813 7304.0625,871.8906 L7304.0625,873.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="7320.25" y="874.3911">Congealing</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7215" x2="7469" y1="883.8906" y2="883.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="7220" y="898.1011">n_alternations : int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="7220" y="910.9058">aligner : MultiscaleIC</text><line style="stroke: #444444; stroke-width: 1.0;" x1="7215" x2="7469" y1="917.5" y2="917.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="207" x="7220" y="931.7104">+congeal(images, medoid_idx) : dict</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7215" x2="7469" y1="938.3047" y2="938.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="7220" y="952.5151">Alternating optimization:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="7220" y="965.3198">1. Fix transforms → median template</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="7220" y="978.1245">2. Fix template → IC registration per image</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="164" x="7220" y="990.9292">Repeat n_alternations times.</text><!--MD5=[1821e832f70fd1849e37ba07e237e643]
class ShapeContextDescriptor--><rect fill="#FEFEFE" height="140.0352" id="ShapeContextDescriptor" style="stroke: #444444; stroke-width: 1.5;" width="285" x="8157.5" y="213.3906"/><ellipse cx="8217.75" cy="227.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M8219.0625,231.1563 Q8218.6875,231.3594 8218.2656,231.4531 Q8217.8594,231.5469 8217.3906,231.5469 Q8215.7813,231.5469 8214.9219,230.4844 Q8214.0625,229.4063 8214.0625,227.3906 Q8214.0625,225.3594 8214.9219,224.2969 Q8215.7813,223.2188 8217.3906,223.2188 Q8217.8594,223.2188 8218.2656,223.3281 Q8218.6875,223.4219 8219.0625,223.6094 L8219.0625,225.375 Q8218.6406,225 8218.25,224.8281 Q8217.875,224.6563 8217.4688,224.6563 Q8216.6094,224.6563 8216.1563,225.3438 Q8215.7188,226.0313 8215.7188,227.3906 Q8215.7188,228.75 8216.1563,229.4375 Q8216.6094,230.125 8217.4688,230.125 Q8217.875,230.125 8218.25,229.9531 Q8218.6406,229.7813 8219.0625,229.3906 L8219.0625,231.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="8235.25" y="231.8911">ShapeContextDescriptor</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8158.5" x2="8441.5" y1="241.3906" y2="241.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="273" x="8163.5" y="255.6011">n_sample_points, n_angular_bins, n_radial_bins</text><line style="stroke: #444444; stroke-width: 1.0;" x1="8158.5" x2="8441.5" y1="262.1953" y2="262.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="8163.5" y="276.4058">+describe(binary) : ndarray (N_s, n_bins)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="8163.5" y="289.2104">+distance(desc_a, desc_b) : float</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8158.5" x2="8250.5" y1="302.207" y2="302.207"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="8250.5" y="305.5151">contour sampling</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8349.5" x2="8441.5" y1="302.207" y2="302.207"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8158.5" x2="8240.5" y1="321.4141" y2="321.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="119" x="8240.5" y="324.7222">log-polar histograms</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8359.5" x2="8441.5" y1="321.4141" y2="321.4141"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8158.5" x2="8201" y1="340.6211" y2="340.6211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="8201" y="343.9292">chi-squared + Hungarian matching</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8399" x2="8441.5" y1="340.6211" y2="340.6211"/><!--MD5=[5598b751f16a565b3dfa2e3cde7d477c]
class PersistentHomologyDescriptor--><rect fill="#FEFEFE" height="132.0352" id="PersistentHomologyDescriptor" style="stroke: #444444; stroke-width: 1.5;" width="289" x="7835.5" y="532.3906"/><ellipse cx="7878.75" cy="546.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7880.0625,550.1563 Q7879.6875,550.3594 7879.2656,550.4531 Q7878.8594,550.5469 7878.3906,550.5469 Q7876.7813,550.5469 7875.9219,549.4844 Q7875.0625,548.4063 7875.0625,546.3906 Q7875.0625,544.3594 7875.9219,543.2969 Q7876.7813,542.2188 7878.3906,542.2188 Q7878.8594,542.2188 7879.2656,542.3281 Q7879.6875,542.4219 7880.0625,542.6094 L7880.0625,544.375 Q7879.6406,544 7879.25,543.8281 Q7878.875,543.6563 7878.4688,543.6563 Q7877.6094,543.6563 7877.1563,544.3438 Q7876.7188,545.0313 7876.7188,546.3906 Q7876.7188,547.75 7877.1563,548.4375 Q7877.6094,549.125 7878.4688,549.125 Q7878.875,549.125 7879.25,548.9531 Q7879.6406,548.7813 7880.0625,548.3906 L7880.0625,550.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="7896.25" y="550.8911">PersistentHomologyDescriptor</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7836.5" x2="8123.5" y1="560.3906" y2="560.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="7841.5" y="574.6011">+compute_persistence(binary) : dict {H0, H1}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="277" x="7841.5" y="587.4058">+wasserstein_distance(dgm_a, dgm_b, q) : float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="7841.5" y="600.2104">+topological_distance(img_a, img_b) : float</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7836.5" x2="7917.5" y1="613.207" y2="613.207"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="7917.5" y="616.5151">gudhi cubical complex</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8042.5" x2="8123.5" y1="613.207" y2="613.207"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7836.5" x2="7900" y1="632.4141" y2="632.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="7900" y="635.7222">distance transform filtration</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8060" x2="8123.5" y1="632.4141" y2="632.4141"/><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7836.5" x2="7893.5" y1="651.6211" y2="651.6211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="173" x="7893.5" y="654.9292">H0 = components, H1 = loops</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8066.5" x2="8123.5" y1="651.6211" y2="651.6211"/><!--MD5=[7cac22e1fe1fcd1bf54c63127c3457d4]
class TopologicalPreFilter--><rect fill="#FEFEFE" height="95.2188" id="TopologicalPreFilter" style="stroke: #444444; stroke-width: 1.5;" width="286" x="7836" y="235.8906"/><ellipse cx="7913.75" cy="249.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7915.0625,253.6563 Q7914.6875,253.8594 7914.2656,253.9531 Q7913.8594,254.0469 7913.3906,254.0469 Q7911.7813,254.0469 7910.9219,252.9844 Q7910.0625,251.9063 7910.0625,249.8906 Q7910.0625,247.8594 7910.9219,246.7969 Q7911.7813,245.7188 7913.3906,245.7188 Q7913.8594,245.7188 7914.2656,245.8281 Q7914.6875,245.9219 7915.0625,246.1094 L7915.0625,247.875 Q7914.6406,247.5 7914.25,247.3281 Q7913.875,247.1563 7913.4688,247.1563 Q7912.6094,247.1563 7912.1563,247.8438 Q7911.7188,248.5313 7911.7188,249.8906 Q7911.7188,251.25 7912.1563,251.9375 Q7912.6094,252.625 7913.4688,252.625 Q7913.875,252.625 7914.25,252.4531 Q7914.6406,252.2813 7915.0625,251.8906 L7915.0625,253.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="7931.25" y="254.3911">TopologicalPreFilter</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7837" x2="8121" y1="263.8906" y2="263.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="7842" y="278.1011">_ph : PersistentHomologyDescriptor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="7842" y="290.9058">_thresh : float</text><line style="stroke: #444444; stroke-width: 1.0;" x1="7837" x2="8121" y1="297.5" y2="297.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="7842" y="311.7104">+signature(binary) : (n_comp, n_loops)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="7842" y="324.5151">+compatibility_mask(signatures) : ndarray (N,N)</text><!--MD5=[15c49feaa09fe409f7d78de5954135f1]
class metrics_mod--><rect fill="#FEFEFE" height="172.0469" id="metrics_mod" style="stroke: #444444; stroke-width: 1.5;" width="284" x="8596" y="512.3906"/><ellipse cx="8662.25" cy="526.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M8663.5625,530.1563 Q8663.1875,530.3594 8662.7656,530.4531 Q8662.3594,530.5469 8661.8906,530.5469 Q8660.2813,530.5469 8659.4219,529.4844 Q8658.5625,528.4063 8658.5625,526.3906 Q8658.5625,524.3594 8659.4219,523.2969 Q8660.2813,522.2188 8661.8906,522.2188 Q8662.3594,522.2188 8662.7656,522.3281 Q8663.1875,522.4219 8663.5625,522.6094 L8663.5625,524.375 Q8663.1406,524 8662.75,523.8281 Q8662.375,523.6563 8661.9688,523.6563 Q8661.1094,523.6563 8660.6563,524.3438 Q8660.2188,525.0313 8660.2188,526.3906 Q8660.2188,527.75 8660.6563,528.4375 Q8661.1094,529.125 8661.9688,529.125 Q8662.375,529.125 8662.75,528.9531 Q8663.1406,528.7813 8663.5625,528.3906 L8663.5625,530.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="8679.75" y="530.8911">&lt;&lt;module&gt;&gt; metrics</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8597" x2="8879" y1="540.3906" y2="540.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="8602" y="554.6011">+compute_metrics(ref, pred) : dict</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="8602" y="567.4058">+compute_purity(ref, pred) : float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="232" x="8602" y="580.2104">+compute_clustering_f1(ref, pred) : float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="8602" y="593.0151">+compute_accuracy_hungarian(ref, pred) : float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="268" x="8602" y="605.8198">+compute_per_class_f1(ref, pred) : DataFrame</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="8602" y="618.6245">+compute_noise_fraction(labels) : float</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="8597" x2="8879" y1="625.2188" y2="625.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="8602" y="639.4292">ARI, NMI, AMI, FMI, V-measure,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="8602" y="652.2339">homogeneity, completeness, purity,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="155" x="8602" y="665.0386">inverse purity, pairwise F1,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="8602" y="677.8433">Hungarian-matched accuracy</text><!--MD5=[cc8b59086a5c83cd2a280b59a21c7c81]
class AblationRunner--><rect fill="#FEFEFE" height="82.4141" id="AblationRunner" style="stroke: #444444; stroke-width: 1.5;" width="337" x="8880.5" y="242.3906"/><ellipse cx="8996.75" cy="256.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M8998.0625,260.1563 Q8997.6875,260.3594 8997.2656,260.4531 Q8996.8594,260.5469 8996.3906,260.5469 Q8994.7813,260.5469 8993.9219,259.4844 Q8993.0625,258.4063 8993.0625,256.3906 Q8993.0625,254.3594 8993.9219,253.2969 Q8994.7813,252.2188 8996.3906,252.2188 Q8996.8594,252.2188 8997.2656,252.3281 Q8997.6875,252.4219 8998.0625,252.6094 L8998.0625,254.375 Q8997.6406,254 8997.25,253.8281 Q8996.875,253.6563 8996.4688,253.6563 Q8995.6094,253.6563 8995.1563,254.3438 Q8994.7188,255.0313 8994.7188,256.3906 Q8994.7188,257.75 8995.1563,258.4375 Q8995.6094,259.125 8996.4688,259.125 Q8996.875,259.125 8997.25,258.9531 Q8997.6406,258.7813 8998.0625,258.3906 L8998.0625,260.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="9014.25" y="260.8911">AblationRunner</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8881.5" x2="9216.5" y1="270.3906" y2="270.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="173" x="8886.5" y="284.6011">ablations : List[AblationConfig]</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8881.5" x2="9216.5" y1="291.1953" y2="291.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="8886.5" y="305.4058">+add_ablation(config)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="8886.5" y="318.2104">+run(pipeline_fn, data, default_params, ref) : DataFrame</text><!--MD5=[48f3f8b5dd362dfbf754642a0c7379ae]
class AblationConfig--><rect fill="#FEFEFE" height="92.3516" id="AblationConfig" style="stroke: #444444; stroke-width: 1.5;" width="221" x="8938.5" y="552.3906"/><ellipse cx="8999.25" cy="571.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M9000.5625,575.125 Q9000.1875,575.3281 8999.7656,575.4219 Q8999.3594,575.5156 8998.8906,575.5156 Q8997.2813,575.5156 8996.4219,574.4531 Q8995.5625,573.375 8995.5625,571.3594 Q8995.5625,569.3281 8996.4219,568.2656 Q8997.2813,567.1875 8998.8906,567.1875 Q8999.3594,567.1875 8999.7656,567.2969 Q9000.1875,567.3906 9000.5625,567.5781 L9000.5625,569.3438 Q9000.1406,568.9688 8999.75,568.7969 Q8999.375,568.625 8998.9688,568.625 Q8998.1094,568.625 8997.6563,569.3125 Q8997.2188,570 8997.2188,571.3594 Q8997.2188,572.7188 8997.6563,573.4063 Q8998.1094,574.0938 8998.9688,574.0938 Q8999.375,574.0938 8999.75,573.9219 Q9000.1406,573.75 9000.5625,573.3594 L9000.5625,575.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="9028.25" y="567.6011">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="9016.75" y="582.2622">AblationConfig</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8939.5" x2="9158.5" y1="590.3281" y2="590.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="8944.5" y="604.5386">name, description</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="209" x="8944.5" y="617.3433">parameter_name, parameter_values</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="8944.5" y="630.1479">default_value</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8939.5" x2="9158.5" y1="636.7422" y2="636.7422"/><!--MD5=[c9719533ea95fe5c5f142484421e0a10]
class eval_mod--><rect fill="#FEFEFE" height="133.6328" id="eval_mod" style="stroke: #444444; stroke-width: 1.5;" width="346" x="8499" y="216.3906"/><ellipse cx="8587.25" cy="230.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M8588.5625,234.1563 Q8588.1875,234.3594 8587.7656,234.4531 Q8587.3594,234.5469 8586.8906,234.5469 Q8585.2813,234.5469 8584.4219,233.4844 Q8583.5625,232.4063 8583.5625,230.3906 Q8583.5625,228.3594 8584.4219,227.2969 Q8585.2813,226.2188 8586.8906,226.2188 Q8587.3594,226.2188 8587.7656,226.3281 Q8588.1875,226.4219 8588.5625,226.6094 L8588.5625,228.375 Q8588.1406,228 8587.75,227.8281 Q8587.375,227.6563 8586.9688,227.6563 Q8586.1094,227.6563 8585.6563,228.3438 Q8585.2188,229.0313 8585.2188,230.3906 Q8585.2188,231.75 8585.6563,232.4375 Q8586.1094,233.125 8586.9688,233.125 Q8587.375,233.125 8587.75,232.9531 Q8588.1406,232.7813 8588.5625,232.3906 L8588.5625,234.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="8604.75" y="234.8911">&lt;&lt;module&gt;&gt; evaluation</text><line style="stroke: #444444; stroke-width: 1.5;" x1="8500" x2="8844" y1="244.3906" y2="244.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="8500" x2="8844" y1="252.3906" y2="252.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="279" x="8505" y="266.6011">+bootstrap_metrics(ref, pred, n_bootstrap) : dict</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="232" x="8505" y="279.4058">+paired_significance_test(ref, a, b) : dict</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="8505" y="292.2104">+get_feature_ablations() : List[AblationConfig]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="8505" y="305.0151">+get_acontrario_ablations()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="155" x="8505" y="317.8198">+get_clustering_ablations()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="8505" y="330.6245">+get_refinement_ablations()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="334" x="8505" y="343.4292">+run_scalability_benchmark(stages, subsets) : DataFrame</text><!--MD5=[32b409a2a6d9d7cd1014a356e211ca6b]
class ReadingOrder--><rect fill="#FEFEFE" height="88.8164" id="ReadingOrder" style="stroke: #444444; stroke-width: 1.5;" width="205" x="7213.5" y="238.8906"/><ellipse cx="7268.75" cy="252.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7270.0625,256.6563 Q7269.6875,256.8594 7269.2656,256.9531 Q7268.8594,257.0469 7268.3906,257.0469 Q7266.7813,257.0469 7265.9219,255.9844 Q7265.0625,254.9063 7265.0625,252.8906 Q7265.0625,250.8594 7265.9219,249.7969 Q7266.7813,248.7188 7268.3906,248.7188 Q7268.8594,248.7188 7269.2656,248.8281 Q7269.6875,248.9219 7270.0625,249.1094 L7270.0625,250.875 Q7269.6406,250.5 7269.25,250.3281 Q7268.875,250.1563 7268.4688,250.1563 Q7267.6094,250.1563 7267.1563,250.8438 Q7266.7188,251.5313 7266.7188,252.8906 Q7266.7188,254.25 7267.1563,254.9375 Q7267.6094,255.625 7268.4688,255.625 Q7268.875,255.625 7269.25,255.4531 Q7269.6406,255.2813 7270.0625,254.8906 L7270.0625,256.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="7286.25" y="257.3911">ReadingOrder</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7214.5" x2="7417.5" y1="266.8906" y2="266.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="7219.5" y="281.1011">min_col_area : int</text><line style="stroke: #444444; stroke-width: 1.0;" x1="7214.5" x2="7417.5" y1="287.6953" y2="287.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="193" x="7219.5" y="301.9058">+__call__(labels, page_df, ...) : fig</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7214.5" x2="7229" y1="314.9023" y2="314.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="7229" y="318.2104">assigns reading_order column</text><line style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="7403" x2="7417.5" y1="314.9023" y2="314.9023"/><!--MD5=[07c1b360cc3a29856545a4ead727b3f2]
class parsing_mod--><rect fill="#FEFEFE" height="69.6094" id="parsing_mod" style="stroke: #444444; stroke-width: 1.5;" width="327" x="7453.5" y="248.3906"/><ellipse cx="7541.75" cy="262.3906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7543.0625,266.1563 Q7542.6875,266.3594 7542.2656,266.4531 Q7541.8594,266.5469 7541.3906,266.5469 Q7539.7813,266.5469 7538.9219,265.4844 Q7538.0625,264.4063 7538.0625,262.3906 Q7538.0625,260.3594 7538.9219,259.2969 Q7539.7813,258.2188 7541.3906,258.2188 Q7541.8594,258.2188 7542.2656,258.3281 Q7542.6875,258.4219 7543.0625,258.6094 L7543.0625,260.375 Q7542.6406,260 7542.25,259.8281 Q7541.875,259.6563 7541.4688,259.6563 Q7540.6094,259.6563 7540.1563,260.3438 Q7539.7188,261.0313 7539.7188,262.3906 Q7539.7188,263.75 7540.1563,264.4375 Q7540.6094,265.125 7541.4688,265.125 Q7541.875,265.125 7542.25,264.9531 Q7542.6406,264.7813 7543.0625,264.3906 L7543.0625,266.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="7559.25" y="266.8911">&lt;&lt;module&gt;&gt; parsing</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7454.5" x2="7779.5" y1="276.3906" y2="276.3906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="7454.5" x2="7779.5" y1="284.3906" y2="284.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="315" x="7459.5" y="298.6011">+split_to_rectangles(labels, min_col_area) : DataFrame</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="7459.5" y="311.4058">+break_into_subcols(col_rects) : list</text><!--MD5=[c03a00bca21d8d9e014e376091e75882]
class skew_mod--><rect fill="#FEFEFE" height="56.8047" id="skew_mod" style="stroke: #444444; stroke-width: 1.5;" width="248" x="7214" y="569.8906"/><ellipse cx="7270.75" cy="583.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M7272.0625,587.6563 Q7271.6875,587.8594 7271.2656,587.9531 Q7270.8594,588.0469 7270.3906,588.0469 Q7268.7813,588.0469 7267.9219,586.9844 Q7267.0625,585.9063 7267.0625,583.8906 Q7267.0625,581.8594 7267.9219,580.7969 Q7268.7813,579.7188 7270.3906,579.7188 Q7270.8594,579.7188 7271.2656,579.8281 Q7271.6875,579.9219 7272.0625,580.1094 L7272.0625,581.875 Q7271.6406,581.5 7271.25,581.3281 Q7270.875,581.1563 7270.4688,581.1563 Q7269.6094,581.1563 7269.1563,581.8438 Q7268.7188,582.5313 7268.7188,583.8906 Q7268.7188,585.25 7269.1563,585.9375 Q7269.6094,586.625 7270.4688,586.625 Q7270.875,586.625 7271.25,586.4531 Q7271.6406,586.2813 7272.0625,585.8906 L7272.0625,587.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="7288.25" y="588.3911">&lt;&lt;module&gt;&gt; skew</text><line style="stroke: #444444; stroke-width: 1.5;" x1="7215" x2="7461" y1="597.8906" y2="597.8906"/><line style="stroke: #444444; stroke-width: 1.5;" x1="7215" x2="7461" y1="605.8906" y2="605.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="236" x="7220" y="620.1011">+get_document_orientation(image) : float</text><!--MD5=[8fe51b892091742d15ad684ccb0dd4a2]
class ModelWrapper--><rect fill="#FEFEFE" height="82.4141" id="ModelWrapper" style="stroke: #444444; stroke-width: 1.5;" width="194" x="1483" y="885.8906"/><ellipse cx="1530.75" cy="899.8906" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M1532.0625,903.6563 Q1531.6875,903.8594 1531.2656,903.9531 Q1530.8594,904.0469 1530.3906,904.0469 Q1528.7813,904.0469 1527.9219,902.9844 Q1527.0625,901.9063 1527.0625,899.8906 Q1527.0625,897.8594 1527.9219,896.7969 Q1528.7813,895.7188 1530.3906,895.7188 Q1530.8594,895.7188 1531.2656,895.8281 Q1531.6875,895.9219 1532.0625,896.1094 L1532.0625,897.875 Q1531.6406,897.5 1531.25,897.3281 Q1530.875,897.1563 1530.4688,897.1563 Q1529.6094,897.1563 1529.1563,897.8438 Q1528.7188,898.5313 1528.7188,899.8906 Q1528.7188,901.25 1529.1563,901.9375 Q1529.6094,902.625 1530.4688,902.625 Q1530.875,902.625 1531.25,902.4531 Q1531.6406,902.2813 1532.0625,901.8906 L1532.0625,903.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="1548.25" y="904.3911">ModelWrapper</text><line style="stroke: #444444; stroke-width: 1.5;" x1="1484" x2="1676" y1="913.8906" y2="913.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="1489" y="928.1011">net : kraken model</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="1489" y="940.9058">pad : int</text><line style="stroke: #444444; stroke-width: 1.0;" x1="1484" x2="1676" y1="947.5" y2="947.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="182" x="1489" y="961.7104">+predict(image) : (chars, confs)</text><!--MD5=[347adc8cb734afb1c4e184deca3cc790]
class run_extraction--><rect fill="#FEFEFE" height="79.5469" id="run_extraction" style="stroke: #444444; stroke-width: 1.5;" width="252" x="1750" y="243.3906"/><ellipse cx="1816.75" cy="262.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M1818.0625,266.125 Q1817.6875,266.3281 1817.2656,266.4219 Q1816.8594,266.5156 1816.3906,266.5156 Q1814.7813,266.5156 1813.9219,265.4531 Q1813.0625,264.375 1813.0625,262.3594 Q1813.0625,260.3281 1813.9219,259.2656 Q1814.7813,258.1875 1816.3906,258.1875 Q1816.8594,258.1875 1817.2656,258.2969 Q1817.6875,258.3906 1818.0625,258.5781 L1818.0625,260.3438 Q1817.6406,259.9688 1817.25,259.7969 Q1816.875,259.625 1816.4688,259.625 Q1815.6094,259.625 1815.1563,260.3125 Q1814.7188,261 1814.7188,262.3594 Q1814.7188,263.7188 1815.1563,264.4063 Q1815.6094,265.0938 1816.4688,265.0938 Q1816.875,265.0938 1817.25,264.9219 Q1817.6406,264.75 1818.0625,264.3594 L1818.0625,266.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="1866.75" y="258.6011">«script»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1834.25" y="273.2622">run_extraction.py</text><line style="stroke: #444444; stroke-width: 1.5;" x1="1751" x2="2001" y1="281.3281" y2="281.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="240" x="1756" y="295.5386">Runs GlobalPipeline on document images.</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="1756" y="308.3433">Saves connectedComponent .npz files.</text><line style="stroke: #444444; stroke-width: 1.5;" x1="1751" x2="2001" y1="314.9375" y2="314.9375"/><!--MD5=[08efd4bce434fc4a4e68430a557e3832]
class run_preprocessing--><rect fill="#FEFEFE" height="79.5469" id="run_preprocessing" style="stroke: #444444; stroke-width: 1.5;" width="281" x="2037.5" y="243.3906"/><ellipse cx="2105.75" cy="262.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2107.0625,266.125 Q2106.6875,266.3281 2106.2656,266.4219 Q2105.8594,266.5156 2105.3906,266.5156 Q2103.7813,266.5156 2102.9219,265.4531 Q2102.0625,264.375 2102.0625,262.3594 Q2102.0625,260.3281 2102.9219,259.2656 Q2103.7813,258.1875 2105.3906,258.1875 Q2105.8594,258.1875 2106.2656,258.2969 Q2106.6875,258.3906 2107.0625,258.5781 L2107.0625,260.3438 Q2106.6406,259.9688 2106.25,259.7969 Q2105.875,259.625 2105.4688,259.625 Q2104.6094,259.625 2104.1563,260.3125 Q2103.7188,261 2103.7188,262.3594 Q2103.7188,263.7188 2104.1563,264.4063 Q2104.6094,265.0938 2105.4688,265.0938 Q2105.875,265.0938 2106.25,264.9219 Q2106.6406,264.75 2107.0625,264.3594 L2107.0625,266.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="2168.75" y="258.6011">«script»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="2123.25" y="273.2622">run_preprocessing.py</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2038.5" x2="2317.5" y1="281.3281" y2="281.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="2043.5" y="295.5386">Runs PatchPreprocessing.</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="269" x="2043.5" y="308.3433">Produces DataFrame with SVGs + HOG + OCR.</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2038.5" x2="2317.5" y1="314.9375" y2="314.9375"/><!--MD5=[49f52e8994451ff15129578f57a3e049]
class sweep_clustering--><rect fill="#FEFEFE" height="79.5469" id="sweep_clustering" style="stroke: #444444; stroke-width: 1.5;" width="177" x="2353.5" y="243.3906"/><ellipse cx="2375.95" cy="262.3594" fill="#ADD1B2" rx="9" ry="9" style="stroke: #444444; stroke-width: 1.0;"/><path d="M2377.2625,266.125 Q2376.8875,266.3281 2376.4656,266.4219 Q2376.0594,266.5156 2375.5906,266.5156 Q2373.9813,266.5156 2373.1219,265.4531 Q2372.2625,264.375 2372.2625,262.3594 Q2372.2625,260.3281 2373.1219,259.2656 Q2373.9813,258.1875 2375.5906,258.1875 Q2376.0594,258.1875 2376.4656,258.2969 Q2376.8875,258.3906 2377.2625,258.5781 L2377.2625,260.3438 Q2376.8406,259.9688 2376.45,259.7969 Q2376.075,259.625 2375.6688,259.625 Q2374.8094,259.625 2374.3563,260.3125 Q2373.9188,261 2373.9188,262.3594 Q2373.9188,263.7188 2374.3563,264.4063 Q2374.8094,265.0938 2375.6688,265.0938 Q2376.075,265.0938 2376.45,264.9219 Q2376.8406,264.75 2377.2625,264.3594 L2377.2625,266.125 Z "/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="2431.05" y="258.6011">«script»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="2390.05" y="273.2622">sweep_clustering.py</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2354.5" x2="2529.5" y1="281.3281" y2="281.3281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="2359.5" y="295.5386">Runs graphClusteringSweep.</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="2359.5" y="308.3433">Produces clustering reports.</text><line style="stroke: #444444; stroke-width: 1.5;" x1="2354.5" x2="2529.5" y1="314.9375" y2="314.9375"/><!--MD5=[4cc6699f1b12eb47e185fdc7290bc2b0]
link GlobalPipeline to craftWrapper--><path d="M691.99,598.3906 C504.43,598.3906 222,598.3906 222,598.3906 C222,598.3906 222,869.1106 222,869.1106 " fill="none" id="GlobalPipeline-&gt;craftWrapper" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="222,874.1106,226,865.1106,222,869.1106,218,865.1106,222,874.1106" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="30" x="409" y="789.6011">owns</text><!--MD5=[e8417f0640bab882dbd3df6f0d155a84]
link GlobalPipeline to imageComponentsPipeline--><path d="M866,698.2906 C866,698.2906 866,842.2406 866,842.2406 " fill="none" id="GlobalPipeline-&gt;imageComponentsPipeline" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="866,847.2406,870,838.2406,866,842.2406,862,838.2406,866,847.2406" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="30" x="862" y="789.6011">owns</text><!--MD5=[4cfa14ffafd796f3ab43e03d96881426]
link GlobalPipeline to PipelineOutput--><path d="M703.25,697.9906 C703.25,794.8306 703.25,927.3906 703.25,927.3906 C703.25,927.3906 684.27,927.3906 684.27,927.3906 " fill="none" id="GlobalPipeline-&gt;PipelineOutput" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="679.27,927.3906,688.27,931.3906,684.27,927.3906,688.27,923.3906,679.27,927.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="662" y="789.6011">produces</text><!--MD5=[134d84a18932b51ddac268446a070849]
link imageComponentsPipeline to compsResult--><path d="M866,1006.4906 C866,1006.4906 866,1164.3206 866,1164.3206 " fill="none" id="imageComponentsPipeline-&gt;compsResult" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="866,1169.3206,870,1160.3206,866,1164.3206,862,1160.3206,866,1169.3206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="867" y="1051.6011">produces</text><!--MD5=[6e12dcb054dec291fad5416cda71004a]
link imageComponentsPipeline to connectedComponent--><path d="M997.75,1006.4206 C997.75,1062.4006 997.75,1127.3906 997.75,1127.3906 C997.75,1127.3906 1209.82,1127.3906 1209.82,1127.3906 " fill="none" id="imageComponentsPipeline-&gt;connectedComponent" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="1214.82,1127.3906,1205.82,1123.3906,1209.82,1127.3906,1205.82,1131.3906,1214.82,1127.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="1080" y="1051.6011">uses</text><!--MD5=[31fe00978bf6036a4f7febf2fb3883a5]
link craftWrapper to connectedComponent--><path d="M222,979.6606 C222,1045.1806 222,1148.3906 222,1148.3906 C222,1148.3906 1209.72,1148.3906 1209.72,1148.3906 " fill="none" id="craftWrapper-&gt;connectedComponent" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="1214.72,1148.3906,1205.72,1144.3906,1209.72,1148.3906,1205.72,1152.3906,1214.72,1148.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="977" y="1051.6011">produces</text><!--MD5=[fa5535c4b8d8d0ee128d6bae7077c246]
link PatchPreprocessing to Renderer--><path d="M2269.75,691.6506 C2269.75,691.6506 2269.75,849.8206 2269.75,849.8206 " fill="none" id="PatchPreprocessing-&gt;Renderer" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2269.75,854.8206,2273.75,845.8206,2269.75,849.8206,2265.75,845.8206,2269.75,854.8206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="2191" y="789.6011">uses</text><!--MD5=[1b58e5f91a77df1bb711bba3ece67244]
link PatchPreprocessing to HOG--><path d="M2330.5,598.3906 C2479.49,598.3906 2684,598.3906 2684,598.3906 C2684,598.3906 2684,863.5406 2684,863.5406 " fill="none" id="PatchPreprocessing-&gt;HOG" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2684,868.5406,2688,859.5406,2684,863.5406,2680,859.5406,2684,868.5406" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="2359" y="789.6011">uses</text><!--MD5=[45901256da4094e5e419d94ed988f4a2]
link PatchPreprocessing to InkFilter--><path d="M2124.17,691.6506 C2124.17,691.6506 2124.17,893.1006 2124.17,893.1006 " fill="none" id="PatchPreprocessing-&gt;InkFilter" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2124.17,898.1006,2128.17,889.1006,2124.17,893.1006,2120.17,889.1006,2124.17,898.1006" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="2104" y="789.6011">uses</text><!--MD5=[e421a4f53601c5e8a66bf42ad94c2f0d]
link Renderer to SVG--><path d="M2301.5,998.9506 C2301.5,998.9506 2301.5,1175.1006 2301.5,1175.1006 " fill="none" id="Renderer-&gt;SVG" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2301.5,1180.1006,2305.5,1171.1006,2301.5,1175.1006,2297.5,1171.1006,2301.5,1180.1006" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="2314" y="1051.6011">renders</text><!--MD5=[eb7d4b9f58c2d36edbab765674abdf60]
link BinaryShapeVectorizer to SVG--><path d="M1968.61,968.3906 C2052.59,968.3906 2150.75,968.3906 2150.75,968.3906 C2150.75,968.3906 2150.75,1175.2606 2150.75,1175.2606 " fill="none" id="BinaryShapeVectorizer-&gt;SVG" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="2150.75,1180.2606,2154.75,1171.2606,2150.75,1175.2606,2146.75,1171.2606,2150.75,1180.2606" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="2009" y="1051.6011">produces</text><!--MD5=[1498020aa8c9257fdebaad3d6a25cd72]
link PatchPreprocessing to BinaryShapeVectorizer--><path d="M2074.83,691.5006 C2074.83,775.6406 2074.83,886.3906 2074.83,886.3906 C2074.83,886.3906 1973.82,886.3906 1973.82,886.3906 " fill="none" id="PatchPreprocessing-&gt;BinaryShapeVectorizer" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="1968.82,886.3906,1977.82,890.3906,1973.82,886.3906,1977.82,882.3906,1968.82,886.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="1943" y="789.6011">uses</text><!--MD5=[399b474e1ec3d3c076e33e9f305d0e5d]
link featureMatching to featureMatchingParameters--><path d="M3888,1004.2006 C3888,1004.2006 3888,1151.1806 3888,1151.1806 " fill="none" id="featureMatching-&gt;featureMatchingParameters" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="3888,1156.1806,3892,1147.1806,3888,1151.1806,3884,1147.1806,3888,1156.1806" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="77" x="3917" y="1051.6011">configured by</text><!--MD5=[a5225228f74c5725ad70db891274a0bc]
link featureMatching to featureMatchingOutputs--><path d="M4065,1004.2006 C4065,1004.2006 4065,1151.1806 4065,1151.1806 " fill="none" id="featureMatching-&gt;featureMatchingOutputs" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="4065,1156.1806,4069,1147.1806,4065,1151.1806,4061,1147.1806,4065,1156.1806" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="4091" y="1051.6011">produces</text><!--MD5=[6f4b8a657c4e5cd7b036e90e152eb2d5]
reverse link communityDetectionBase to leidenCommunityDetection--><path d="M6540,975.7606 C6540,975.7606 6540,1187.3906 6540,1187.3906 C6540,1187.3906 6633.38,1187.3906 6710.72,1187.3906 " fill="none" id="communityDetectionBase&lt;-leidenCommunityDetection" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="6533,975.7606,6540,955.7606,6547,975.7606,6533,975.7606" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[8a1e42071fa183cffc516b6343328c39]
reverse link communityDetectionBase to louvainCommunityDetection--><path d="M6591.5,975.6006 C6591.5,975.6006 6591.5,979.3906 6591.5,979.3906 C6591.5,979.3906 7053,979.3906 7053,979.3906 C7053,979.3906 7053,1123.4306 7053,1186.4506 " fill="none" id="communityDetectionBase&lt;-louvainCommunityDetection" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="6584.5,975.6006,6591.5,955.6006,6598.5,975.6006,6584.5,975.6006" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[69a73ee12ee1713f5ed1ad425d535ff4]
reverse link communityDetectionBase to greedyModularityCommunityDetection--><path d="M6416.88,927.3906 C6416.88,927.3906 6328.17,927.3906 6328.17,927.3906 C6328.17,927.3906 6328.17,1125.8306 6328.17,1193.2706 " fill="none" id="communityDetectionBase&lt;-greedyModularityCommunityDetection" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="6416.88,920.3906,6436.88,927.3906,6416.88,934.3906,6416.88,920.3906" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[3d3cfa40335c091140341600e6ac667d]
reverse link communityDetectionBase to labelPropagationCommunityDetection--><path d="M6488.5,975.6106 C6488.5,975.6106 6488.5,1193.2806 6488.5,1193.2806 " fill="none" id="communityDetectionBase&lt;-labelPropagationCommunityDetection" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="6481.5,975.6106,6488.5,955.6106,6495.5,975.6106,6481.5,975.6106" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[47bbb9c9e77d1dfc91246ccd18df7a9c]
link graphClustering to communityDetectionBase--><path d="M6483.25,665.6606 C6483.25,665.6606 6483.25,893.3806 6483.25,893.3806 " fill="none" id="graphClustering-&gt;communityDetectionBase" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6483.25,898.3806,6487.25,889.3806,6483.25,893.3806,6479.25,889.3806,6483.25,898.3806" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="6465" y="789.6011">uses</text><!--MD5=[12baae07ee893bc7b3e61284af5009a1]
link graphClustering to featureMatching--><path d="M6287.33,665.4406 C6287.33,743.3606 6287.33,861.3906 6287.33,861.3906 C6287.33,861.3906 4108.68,861.3906 4108.68,861.3906 " fill="none" id="graphClustering-&gt;featureMatching" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="4103.68,861.3906,4112.68,865.3906,4108.68,861.3906,4112.68,857.3906,4103.68,861.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="4142" y="789.6011">uses</text><!--MD5=[0da4a98fd8c1cecab16c5011b1926f2a]
link graphClusteringSweep to AutoReport--><path d="M3186.88,748.4006 C3186.88,817.0606 3186.88,883.3906 3186.88,883.3906 C3186.88,883.3906 3491.82,883.3906 3491.82,883.3906 " fill="none" id="graphClusteringSweep-&gt;AutoReport" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="3491.82,876.3906,3511.82,883.3906,3491.82,890.3906,3491.82,876.3906" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[c8d2d2d57f4170396d943f0faa0b1f0a]
link graphClusteringSweep to featureMatching--><path d="M3207.62,748.5006 C3207.62,806.1506 3207.62,858.3906 3207.62,858.3906 C3207.62,858.3906 3779.22,858.3906 3779.22,858.3906 " fill="none" id="graphClusteringSweep-&gt;featureMatching" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="3784.22,858.3906,3775.22,854.3906,3779.22,858.3906,3775.22,862.3906,3784.22,858.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="3588" y="789.6011">uses</text><!--MD5=[c8d2d2d57f4170396d943f0faa0b1f0a]
link graphClusteringSweep to featureMatching--><path d="M3197.25,748.5106 C3197.25,807.9506 3197.25,862.3906 3197.25,862.3906 C3197.25,862.3906 3779.26,862.3906 3779.26,862.3906 " fill="none" id="graphClusteringSweep-&gt;featureMatching-1" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="3784.26,862.3906,3775.26,858.3906,3779.26,862.3906,3775.26,866.3906,3784.26,862.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="3748" y="789.6011">NLFA matrix</text><!--MD5=[a9a965c8bd1ad55ce2d9305202c623b4]
link graphClusteringSweep to ClusteringSweepReporter--><path d="M3043,748.7006 C3043,748.7006 3043,886.6906 3043,886.6906 " fill="none" id="graphClusteringSweep-&gt;ClusteringSweepReporter" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="3043,891.6906,3047,882.6906,3043,886.6906,3039,882.6906,3043,891.6906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="3044" y="789.6011">delegates to</text><!--MD5=[1d6be77e21dc02a79e7b5e3345adff9f]
reverse link ClusterRefinementStep to HausdorffSplitStep--><path d="M5028.64,915.3906 C5028.64,915.3906 5569,915.3906 5569,915.3906 C5569,915.3906 5569,1067.0206 5569,1154.6806 " fill="none" id="ClusterRefinementStep&lt;-HausdorffSplitStep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="5028.64,922.3906,5008.64,915.3906,5028.64,908.3906,5028.64,922.3906" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[9464e93fa9938367f6694740811f0391]
reverse link ClusterRefinementStep to OCRRematchStep--><path d="M4799,981.9806 C4799,981.9806 4799,1167.8806 4799,1167.8806 " fill="none" id="ClusterRefinementStep&lt;-OCRRematchStep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="4792,981.9806,4799,961.9806,4806,981.9806,4792,981.9806" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[a07d85f3771ba0a1c3a3ac61f6e180f5]
reverse link ClusterRefinementStep to PCAZScoreRematchStep--><path d="M5028.57,939.3906 C5028.57,939.3906 5300,939.3906 5300,939.3906 C5300,939.3906 5300,1080.8106 5300,1161.1906 " fill="none" id="ClusterRefinementStep&lt;-PCAZScoreRematchStep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="5028.57,946.3906,5008.57,939.3906,5028.57,932.3906,5028.57,946.3906" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[b0c427e1961b55960fbd8e716985afd7]
reverse link ClusterRefinementStep to MRFRefinementStep--><path d="M4618,981.9806 C4618,981.9806 4618,1154.6606 4618,1154.6606 " fill="none" id="ClusterRefinementStep&lt;-MRFRefinementStep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="4611,981.9806,4618,961.9806,4625,981.9806,4611,981.9806" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[f828e3bfa5f90939674f31440ba4d939]
reverse link ClusterRefinementStep to KMedoidsSplitMergeStep--><path d="M4980,981.9806 C4980,981.9806 4980,1161.1406 4980,1161.1406 " fill="none" id="ClusterRefinementStep&lt;-KMedoidsSplitMergeStep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="4973,981.9806,4980,961.9806,4987,981.9806,4973,981.9806" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[0f986b045e5e58102d6455bbc381d7da]
link ClusterRefinementStep to RefinementResult--><path d="M4589.17,927.3906 C4466.67,927.3906 4336,927.3906 4336,927.3906 C4336,927.3906 4336,1164.1206 4336,1164.1206 " fill="none" id="ClusterRefinementStep-&gt;RefinementResult" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="4336,1169.1206,4340,1160.1206,4336,1164.1206,4332,1160.1206,4336,1169.1206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="4472" y="1051.6011">produces</text><!--MD5=[83eb67e3858cd53fd819acb8ce9c34e5]
link graphClusteringSweep to ClusterRefinementStep--><path d="M3218.2,727.3906 C3662.64,727.3906 4799,727.3906 4799,727.3906 C4799,727.3906 4799,886.6806 4799,886.6806 " fill="none" id="graphClusteringSweep-&gt;ClusterRefinementStep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="4799,891.6806,4803,882.6806,4799,886.6806,4795,882.6806,4799,891.6806" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="3902" y="789.6011">chains</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="4775.8344" y="881.5148">0..*</text><!--MD5=[5a45eb80717a3450fce2b9b9aba94c47]
link MRFRefinementStep to MRFBeliefPropagation--><path d="M4614.25,1276.1006 C4614.25,1276.1006 4614.25,1439.7206 4614.25,1439.7206 " fill="none" id="MRFRefinementStep-&gt;MRFBeliefPropagation" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="4614.25,1444.7206,4618.25,1435.7206,4614.25,1439.7206,4610.25,1435.7206,4614.25,1444.7206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="4659" y="1368.6011">wraps</text><!--MD5=[14acff41659d837363a74c06abd3b82f]
link KMedoidsSplitMergeStep to KMedoidsSplitMerge--><path d="M5029,1269.4706 C5029,1269.4706 5029,1417.1206 5029,1417.1206 " fill="none" id="KMedoidsSplitMergeStep-&gt;KMedoidsSplitMerge" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="5029,1422.1206,5033,1413.1206,5029,1417.1206,5025,1413.1206,5029,1422.1206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="5025" y="1368.6011">wraps</text><!--MD5=[1695cca9978a5bdeef45211f7f98a556]
reverse link Transformation to PlanarTransform--><path d="M6803.75,1834.1206 C6803.75,1834.1206 6803.75,1910.0106 6803.75,1910.0106 " fill="none" id="Transformation&lt;-PlanarTransform" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="none" points="6796.75,1834.1206,6803.75,1814.1206,6810.75,1834.1206,6796.75,1834.1206" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[32e068776e28e86c811c60f6e6033e6b]
link MultiscaleIC to InverseCompositional--><path d="M6237,1565.5206 C6237,1565.5206 6237,1665.1306 6237,1665.1306 " fill="none" id="MultiscaleIC-&gt;InverseCompositional" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6237,1670.1306,6241,1661.1306,6237,1665.1306,6233,1661.1306,6237,1670.1306" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="6238" y="1637.6011">uses</text><!--MD5=[02804a0fed7ddfdaf6bbe5b3ba659c4d]
link MultiscaleIC to GaussianPyramid--><path d="M6348.2,1508.3906 C6436.42,1508.3906 6545,1508.3906 6545,1508.3906 C6545,1508.3906 6545,1703.7406 6545,1703.7406 " fill="none" id="MultiscaleIC-&gt;GaussianPyramid" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6545,1708.7406,6549,1699.7406,6545,1703.7406,6541,1699.7406,6545,1708.7406" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="6427" y="1637.6011">uses</text><!--MD5=[e4f0129c256e2ee2c056a1a5ac8aabcb]
link InverseCompositional to PlanarTransform--><path d="M6370,1836.8306 C6370,1877.3506 6370,1917.3906 6370,1917.3906 C6370,1917.3906 6536.34,1917.3906 6536.34,1917.3906 " fill="none" id="InverseCompositional-&gt;PlanarTransform" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6541.34,1917.3906,6532.34,1913.3906,6536.34,1917.3906,6532.34,1921.3906,6541.34,1917.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="6491" y="1877.6011">produces</text><!--MD5=[ac510fb74f852217db5aca51b9db498f]
link InverseCompositional to Gradients--><path d="M6237,1836.4306 C6237,1836.4306 6237,1917.8506 6237,1917.8506 " fill="none" id="InverseCompositional-&gt;Gradients" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6237,1922.8506,6241,1913.8506,6237,1917.8506,6233,1913.8506,6237,1922.8506" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="6238" y="1877.6011">uses</text><!--MD5=[e39287cc0a5ebafedea8c9be1419fc34]
link MSTAlignment to align_utils--><path d="M7526.5,1010.7206 C7526.5,1010.7206 7526.5,1162.8006 7526.5,1162.8006 " fill="none" id="MSTAlignment-&gt;align_utils" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="7526.5,1167.8006,7530.5,1158.8006,7526.5,1162.8006,7522.5,1158.8006,7526.5,1167.8006" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="7557" y="1051.6011">uses</text><!--MD5=[bcf40773954be0b01edfd2dff7c9ce71]
link Congealing to align_utils--><path d="M7342,998.2006 C7342,998.2006 7342,1162.4606 7342,1162.4606 " fill="none" id="Congealing-&gt;align_utils" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="7342,1167.4606,7346,1158.4606,7342,1162.4606,7338,1158.4606,7342,1167.4606" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="7362" y="1051.6011">uses</text><!--MD5=[ceaef72912ad2c806adf7493c035ea1b]
link align_utils to MultiscaleIC--><path d="M7213.77,1257.3906 C6904.41,1257.3906 6274,1257.3906 6274,1257.3906 C6274,1257.3906 6274,1446.1206 6274,1446.1206 " fill="none" id="align_utils-&gt;MultiscaleIC" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6274,1451.1206,6278,1442.1206,6274,1446.1206,6270,1442.1206,6274,1451.1206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="6709" y="1368.6011">creates</text><!--MD5=[de05315e705713b8cc96975ecff66e75]
link align_utils to PlanarTransform--><path d="M7381,1263.1406 C7381,1430.9306 7381,1983.3906 7381,1983.3906 C7381,1983.3906 6931.81,1983.3906 6931.81,1983.3906 " fill="none" id="align_utils-&gt;PlanarTransform" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6926.81,1983.3906,6935.81,1987.3906,6931.81,1983.3906,6935.81,1979.3906,6926.81,1983.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="7248" y="1637.6011">uses</text><!--MD5=[13dc6cd650384ae433d49001049fd672]
link TopologicalPreFilter to PersistentHomologyDescriptor--><path d="M7979,331.2306 C7979,331.2306 7979,527.2306 7979,527.2306 " fill="none" id="TopologicalPreFilter-&gt;PersistentHomologyDescriptor" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="7979,532.2306,7983,523.2306,7979,527.2306,7975,523.2306,7979,532.2306" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="7980" y="394.6011">uses</text><!--MD5=[1836437cd6d831e98bbb821a47977238]
link AblationRunner to AblationConfig--><path d="M9049,324.5706 C9049,324.5706 9049,547.3406 9049,547.3406 " fill="none" id="AblationRunner-&gt;AblationConfig" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="9049,552.3406,9053,543.3406,9049,547.3406,9045,543.3406,9049,552.3406" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="9050" y="394.6011">has many</text><!--MD5=[b4d45d8787ab780104012cb911911007]
link AblationRunner to metrics_mod--><path d="M8909.5,324.5106 C8909.5,395.2306 8909.5,532.3906 8909.5,532.3906 C8909.5,532.3906 8885.02,532.3906 8885.02,532.3906 " fill="none" id="AblationRunner-&gt;metrics_mod" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="8880.02,532.3906,8889.02,536.3906,8885.02,532.3906,8889.02,528.3906,8880.02,532.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="8862" y="394.6011">uses</text><!--MD5=[10bd9fe58bb50bfc273562b555587d9c]
link eval_mod to metrics_mod--><path d="M8720.5,350.5806 C8720.5,350.5806 8720.5,507.1206 8720.5,507.1206 " fill="none" id="eval_mod-&gt;metrics_mod" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="8720.5,512.1206,8724.5,503.1206,8720.5,507.1206,8716.5,503.1206,8720.5,512.1206" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="8695" y="394.6011">uses</text><!--MD5=[98893df2d26756a240014bd26de51801]
link run_extraction to GlobalPipeline--><path d="M1749.78,283.3906 C1476.61,283.3906 855,283.3906 855,283.3906 C855,283.3906 855,493.7206 855,493.7206 " fill="none" id="run_extraction-&gt;GlobalPipeline" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="855,498.7206,859,489.7206,855,493.7206,851,489.7206,855,498.7206" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[8654655a7bd2e9b63cc970f31c8b04bb]
link run_preprocessing to PatchPreprocessing--><path d="M2178,323.6006 C2178,323.6006 2178,500.2506 2178,500.2506 " fill="none" id="run_preprocessing-&gt;PatchPreprocessing" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2178,505.2506,2182,496.2506,2178,500.2506,2174,496.2506,2178,505.2506" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[93d555c0bc0c490873718aa235fc9d6c]
link sweep_clustering to graphClusteringSweep--><path d="M2525.75,323.4306 C2525.75,379.4406 2525.75,474.3906 2525.75,474.3906 C2525.75,474.3906 2862.88,474.3906 2862.88,474.3906 " fill="none" id="sweep_clustering-&gt;graphClusteringSweep" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2867.88,474.3906,2858.88,470.3906,2862.88,474.3906,2858.88,478.3906,2867.88,474.3906" style="stroke: #555555; stroke-width: 1.0;"/><!--MD5=[cc1db7ba635042f49ff13a10a8222894]
link GlobalPipeline to connectedComponent--><path d="M1018.12,567.3906 C1162.01,567.3906 1349,567.3906 1349,567.3906 C1349,567.3906 1349,1100.1006 1349,1100.1006 " fill="none" id="GlobalPipeline-&gt;connectedComponent" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="1349,1105.1006,1353,1096.1006,1349,1100.1006,1345,1096.1006,1349,1105.1006" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="1137" y="931.1011">produces characters</text><!--MD5=[9c73a5e9453dd86ef6e2ca2f6f6a5594]
link PatchPreprocessing to connectedComponent--><path d="M2191.25,691.6706 C2191.25,844.2406 2191.25,1130.3906 2191.25,1130.3906 C2191.25,1130.3906 1512.04,1130.3906 1512.04,1130.3906 " fill="none" id="PatchPreprocessing-&gt;connectedComponent" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="1507.04,1130.3906,1516.04,1134.3906,1512.04,1130.3906,1516.04,1126.3906,1507.04,1130.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="1358" y="931.1011">loads from .npz</text><!--MD5=[6c348ddcbee57b27dfe1c074498f4a0f]
link PatchPreprocessing to ModelWrapper--><path d="M2025.16,629.3906 C1847.99,629.3906 1580,629.3906 1580,629.3906 C1580,629.3906 1580,880.8406 1580,880.8406 " fill="none" id="PatchPreprocessing-&gt;ModelWrapper" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="1580,885.8406,1584,876.8406,1580,880.8406,1576,876.8406,1580,885.8406" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="1695" y="789.6011">OCR predictions</text><!--MD5=[8d21653e38d674a710c37daaf7edb312]
link graphClusteringSweep to Renderer--><path d="M2881.83,748.6706 C2881.83,809.3806 2881.83,865.3906 2881.83,865.3906 C2881.83,865.3906 2526.12,865.3906 2526.12,865.3906 " fill="none" id="graphClusteringSweep-&gt;Renderer" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2521.12,865.3906,2530.12,869.3906,2526.12,865.3906,2530.12,861.3906,2521.12,865.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="104" x="2452" y="789.6011">creates per config</text><!--MD5=[ae4171e8e7e8dd9b34f3bc3bb6b9627c]
link graphClusteringSweep to HOG--><path d="M2895.67,748.5106 C2895.67,813.2406 2895.67,874.3906 2895.67,874.3906 C2895.67,874.3906 2816.71,874.3906 2816.71,874.3906 " fill="none" id="graphClusteringSweep-&gt;HOG" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="2811.71,874.3906,2820.71,878.3906,2816.71,874.3906,2820.71,870.3906,2811.71,874.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="2789" y="789.6011">computes features</text><!--MD5=[f8016a1928b4528178193a1e0cc5f85f]
link graphClusteringSweep to post_mod--><path d="M3218.12,706.3906 C3838.41,706.3906 5894,706.3906 5894,706.3906 C5894,706.3906 5894,861.3506 5894,861.3506 " fill="none" id="graphClusteringSweep-&gt;post_mod" style="stroke: #555555; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#555555" points="5894,866.3506,5898,857.3506,5894,861.3506,5890,857.3506,5894,866.3506" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="4004" y="789.6011">post-clustering</text><!--MD5=[45714f388c69c725ac51b0320ddad82c]
link HausdorffSplitStep to MultiscaleIC--><path d="M5692.54,1269.3906 C5876.24,1269.3906 6200,1269.3906 6200,1269.3906 C6200,1269.3906 6200,1446.1406 6200,1446.1406 " fill="none" id="HausdorffSplitStep-&gt;MultiscaleIC" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6200,1451.1406,6204,1442.1406,6200,1446.1406,6196,1442.1406,6200,1451.1406" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="5704" y="1368.6011">IC registration</text><!--MD5=[5f7ea1cbc511f9b96e4cbb1d561cb583]
link PCAZScoreRematchStep to MultiscaleIC--><path d="M5300,1269.4706 C5300,1354.1306 5300,1508.3906 5300,1508.3906 C5300,1508.3906 6120.83,1508.3906 6120.83,1508.3906 " fill="none" id="PCAZScoreRematchStep-&gt;MultiscaleIC" style="stroke: #555555; stroke-width: 1.0;"/><polygon fill="#555555" points="6125.83,1508.3906,6116.83,1504.3906,6120.83,1508.3906,6116.83,1512.3906,6125.83,1508.3906" style="stroke: #555555; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="5508" y="1368.6011">IC registration</text><!--MD5=[67eead0e04a05fa6f50c4dedaf1238e8]
link ReadingOrder to parsing_mod--><!--MD5=[fb7f6958ca33117c6d33cc8c79cad031]
link ReadingOrder to skew_mod--><text fill="#888888" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="225" x="4521.5" y="2108.6011">Generated from codebase | OCRProject</text><!--MD5=[e6bf800e9e41cf496022c69eff1b6e06]
@startuml OCRProject Architecture
skinparam linetype ortho
skinparam classAttributeIconSize 0
skinparam defaultFontSize 11
skinparam classFontSize 13
skinparam packageFontSize 14
skinparam titleFontSize 18
skinparam shadowing false
skinparam class {
  BackgroundColor #FEFEFE
  BorderColor #444444
  ArrowColor #555555
}

title A Contrario Character Clustering — Complete Architecture
footer Generated from codebase | OCRProject


legend top left
  |= Color |= Package |
  |<back:#E8F5E9>    </back>| Detection (OCR / CRAFT) |
  |<back:#E3F2FD>    </back>| Patch Processing |
  |<back:#FFF3E0>    </back>| Clustering & A Contrario |
  |<back:#F3E5F5>    </back>| Registration |
  |<back:#FFEBEE>    </back>| Refinement |
  |<back:#E0F7FA>    </back>| Evaluation & Metrics |
  |<back:#FFF9C4>    </back>| Utilities & Reporting |
endlegend


package "src.utils" as utils_pkg #FFF9C4 {

  class connectedComponent <<dataclass>> {
    _labels : ndarray
    _regions : List[RegionProperties]
    _deleted_labels : set
    _merge_mapping : dict
    - -
    +from_image(image, connectivity) : CC
    +from_labels(labels, stats, intensity_image) : CC
    +from_image_watershed(image, ...) : CC
    +delete(label, reason)
    +merge(link_matrix, labels_list)
    +save(filepath) / load(filepath)
    +labels : ndarray  «property»
    +regions : List  «property»
    +segm_img : ndarray  «property»
  }

  class Timer {
    +__call__(string)
  }

  note right of connectedComponent
    Central data structure carrying
    segmented character components
    across the entire pipeline.
  end note
}

package "src.auto_report" as report_pkg #FFF9C4 {
  class AutoReport {
    +title, author, output_dir
    +section(name) «context manager»
    +report_figure(fig, title)
    +save()
  }
  class ReportConfig <<dataclass>> {
    dpi, output_format, image_quality
    theme, show_progress
  }
}


package "src.ocr — Character Detection" as ocr_pkg #E8F5E9 {

  class GlobalPipeline <<orchestrator>> {
    craftDetector : craftWrapper
    imageComponentsPipeline : imageComponentsPipeline
    - -
    +forward(img_pil, verbose) : PipelineOutput
    ..substeps..
    1. CRAFT detection (score maps)
    2. Watershed segmentation
    3. Component filtering & merging
    4. Binarization
    5. Image component extraction
    6. CRAFT↔image component matching
    7. Character filtering
  }

  class craftWrapper <<nn.Module>> {
    model : CRAFT
    params : craftParams
    - -
    +forward(img_tensor) : (preprocessed, score_text, score_link)
    +map_original_to_preprocessed(points, original_shape)
  }

  class imageComponentsPipeline {
    params : imageComponentsParams
    craftDetector : craftWrapper
    - -
    +forward(im_pil, craftComponents) : compsResult
    -binarize(im_pil) : ndarray
    -filter_image_components(cc) : cc
    -compute_similarities(imgCC, craftCC) : ndarray
    -merge_from_similarities(imgCC, craftCC, sim) : cc
    -filter_bad_characters(cc) : cc
    -filter_centroids_by_contour_proximity(...)
  }

  class PipelineOutput <<NamedTuple>> {
    img_pil, preprocessed, binary_img
    score_text, score_link
    craft_components, image_components
    filtered_image_components, characters
    similarity_matrix
  }

  class compsResult <<NamedTuple>> {
    binary_img, img_components
    filtered_img_components, characters
    similarity_matrix
  }

  GlobalPipeline - -> craftWrapper : owns
  GlobalPipeline - -> imageComponentsPipeline : owns
  GlobalPipeline ..> PipelineOutput : produces
  imageComponentsPipeline ..> compsResult : produces
  imageComponentsPipeline - -> connectedComponent : uses
  craftWrapper ..> connectedComponent : produces
}


package "src.patch_processing — Feature Extraction" as patch_pkg #E3F2FD {

  class PatchPreprocessing <<orchestrator>> {
    ink_filter : InkFilter
    vectorizer : BinaryShapeVectorizer
    chat_model : ModelWrapper
    hog_renderer : Renderer
    hog : HOG
    reading_order : ReadingOrder
    - -
    +__call__(image_folder, comps_folder) : DataFrame
    ..substeps..
    CPU: extract → ink_filter → vectorize → deskew
    GPU: OCR (CHAT/Kraken) → HOG features
  }

  class Renderer <<Dataset>> {
    scale, dpi, bin_thresh
    canvas_dims : CanvasDimensions
    cached_renders : List[ndarray]
    - -
    +__call__(svg_imgs) : self
    +__getitem__(idx) : Tensor
    -_precompute_canvas()
    -_place_on_canvas(binary_svg, barycenter) : ndarray
  }

  class HOG {
    _params : HOGParameters
    dx_conv, dy_conv : nn.Sequential
    - -
    +__call__(batch) : fullHOGOutput
    ..
    Computes gradient orientation histograms
    with trilinear binning on rendered SVGs.
  }

  class InkFilter {
    +__call__(patches) : List
  }

  class SVG {
    +render(dpi, output_format, scale) : ndarray
    +apply_homography(H)
  }

  PatchPreprocessing - -> Renderer : uses
  PatchPreprocessing - -> HOG : uses
  PatchPreprocessing - -> InkFilter : uses
  Renderer - -> SVG : renders
}

package "src.vectorization" as vec_pkg #E3F2FD {
  class BinaryShapeVectorizer {
    config : VectorizerConfig
    - -
    +__call__(patches) : Iterator[(idx, SVG)]
    .. calls external C++ executable ..
    .. binary patch → SVG contour ..
  }
  BinaryShapeVectorizer ..> SVG : produces
  PatchPreprocessing - -> BinaryShapeVectorizer : uses
}


package "src.clustering — A Contrario Framework" as ac_pkg #FFF3E0 {

  class featureMatching {
    _params : featureMatchingParameters
    - -
    +match(query, key) : (matches, nlfa, dissim, mu, var)
    +compute_delta(dissim) : (nlfa, mu, var)
    +compute_dissimilarities(queries, keys) : Tensor
    +match_subset(query, key, match_indices, deltas)
    ..
    Metrics: CEMD (Circular Earth Mover's)
             L2 (Euclidean)
    NLFA = −log Φ(standardized)
  }

  class featureMatchingParameters <<dataclass>> {
    metric : str = "CEMD"
    epsilon : float
    distribution : str = "normal"
    partial_output : bool
    reciprocal_only : bool
  }

  class featureMatchingOutputs <<dataclass>> {
    match_indices : Tensor
    nlfa : Tensor
    dissimilarities : Tensor
    nlfa_threshold : float
    nlfa2 : Tensor
  }

  featureMatching - -> featureMatchingParameters : configured by
  featureMatching ..> featureMatchingOutputs : produces
}


package "src.clustering — Graph Clustering" as graph_pkg #FFF3E0 {

  abstract class communityDetectionBase {
    +{abstract} __call__(G: Graph) : Membership
  }

  class leidenCommunityDetection {
    gamma : float
    +__call__(G) : Membership
  }
  class louvainCommunityDetection {
    +__call__(G) : Membership
  }
  class greedyModularityCommunityDetection
  class labelPropagationCommunityDetection

  class graphClustering {
    featureMatcher : featureMatching
    communityDetection : communityDetectionBase
    edges_type : str
    - -
    +__call__(dataframe) : Membership
    .. builds NX graph from NLFA ..
    .. runs community detection ..
  }

  communityDetectionBase <|- - leidenCommunityDetection
  communityDetectionBase <|- - louvainCommunityDetection
  communityDetectionBase <|- - greedyModularityCommunityDetection
  communityDetectionBase <|- - labelPropagationCommunityDetection
  graphClustering - -> communityDetectionBase : uses
  graphClustering - -> featureMatching : uses

  note right of communityDetectionBase
    Wrapped distance-based alternatives:
    hdbscan(), dbscan(), optics(),
    affinity_propagation(), mean_shift()
    All use @sklearn_wrap decorator.
    nlfa_to_distance() converts
    NLFA similarity to metric space.
  end note
}


package "src.clustering — Sweep Orchestrator" as sweep_pkg #FFF3E0 {

  class graphClusteringSweep <<main orchestrator>> {
    featureMatcher : featureMatching
    reporter : ClusteringSweepReporter
    refinement_steps : List[ClusterRefinementStep]
    - -
    +__call__(dataframe) : (df, filtered_df, reps_df, G, partition)
    +report_graph(df, nlfa, dissim, eps, gamma, renderer)
    +get_graph(nlfa, dissim, epsilon) : (Graph, edges)
    ..
    **__call__ substeps:**
    1. Sweep HOG configs (cell_size × bins × sigma × norm)
    2. Compute HOG features via Renderer + HOG
    3. A contrario matching → NLFA matrix
    4. Sweep ε × γ → Leiden partitions → best ARI
    5. report_graph() with best config
    ..
    **report_graph substeps:**
    1. Build NX graph + Leiden partition
    2. Run refinement pipeline (steps)
    3. Post-clustering (CHAT split, hapax, glossary)
    4. Compute purity & completeness
    5. Delegate reporting
  }

  class ClusteringSweepReporter {
    +report_hog_sweep(results_df, hog_configs)
    +report_graph_results(...)
  }

  graphClusteringSweep - -|> AutoReport
  graphClusteringSweep - -> featureMatching : uses
  graphClusteringSweep - -> ClusteringSweepReporter : delegates to
}


package "src.clustering — Refinement Steps" as refine_pkg #FFEBEE {

  class RefinementResult <<dataclass>> {
    membership : ndarray
    log : List[Dict]
    metadata : Dict
  }

  abstract class ClusterRefinementStep {
    name : str
    +{abstract} run(df, membership, renderer, *, target_lbl, **ctx) : RefinementResult
  }

  class HausdorffSplitStep {
    name = "hausdorff_split"
    thresholds, linkage_method
    - -
    Pairwise IC registration → Hausdorff
    distance → hierarchical linkage → fcluster
    Unknown-label patches reassigned to
    largest sub-cluster.
  }

  class OCRRematchStep {
    name = "ocr_rematch"
    max_cluster_size : int
    - -
    Merge small clusters into largest
    cluster with same dominant OCR label.
  }

  class PCAZScoreRematchStep {
    name = "pca_zscore_rematch"
    pca_k, z_max, n_candidates
    - -
    Register query onto anchor → PCA of
    target → z-score test → merge if
    max|z| < z_max.
  }

  class MRFRefinementStep {
    name = "mrf_bp"
    mrf : MRFBeliefPropagation
    - -
    Unary: OCR probabilities
    Pairwise: generalized Potts (NLFA)
    Inference: max-sum loopy BP
    Requires nlfa in ctx.
  }

  class KMedoidsSplitMergeStep {
    name = "kmedoids_split_merge"
    kmedoids : KMedoidsSplitMerge
    - -
    reassign → spectral split (Fiedler)
    → NFA-validated merge
    Requires nlfa in ctx.
  }

  ClusterRefinementStep <|- - HausdorffSplitStep
  ClusterRefinementStep <|- - OCRRematchStep
  ClusterRefinementStep <|- - PCAZScoreRematchStep
  ClusterRefinementStep <|- - MRFRefinementStep
  ClusterRefinementStep <|- - KMedoidsSplitMergeStep
  ClusterRefinementStep ..> RefinementResult : produces

  graphClusteringSweep - -> "0..*" ClusterRefinementStep : chains
}


package "src.clustering — Refinement Engines" as refine_eng #FFEBEE {

  class MRFBeliefPropagation {
    beta, max_iter, damping
    - -
    +fit(nlfa, edges, ocr_probs, init_labels) : dict
    .. max-sum loopy BP ..
    .. damped message passing ..
    .. converges on stable assignment ..
  }

  class KMedoidsSplitMerge {
    max_iter, split_threshold_sigma
    min_split_size, merge_nlfa_threshold
    - -
    +fit(init_labels, nlfa, D) : dict
    -_medoids(labels, D) : dict
    -_reassign(labels, D, medoids) : int
    -_split(labels, D, nlfa, threshold) : int
    -_merge(labels, nlfa, medoids) : int
    .. Fiedler vector spectral bisection ..
    .. NFA-validated cross-edge merging ..
  }

  MRFRefinementStep - -> MRFBeliefPropagation : wraps
  KMedoidsSplitMergeStep - -> KMedoidsSplitMerge : wraps
}


package "src.clustering.post_clustering" as post_pkg #FFF3E0 {
  class "<<module>>" as post_mod {
    +chat_split_clusters(df, dissim, ...) : (df, log)
    +associate_hapax(df, dissim, ...) : (df, log)
    +build_glossary(df, target_lbl) : DataFrame
    ..
    CHAT-based split: impure clusters → subclusters
    Hapax association: singletons → nearest cluster
    Glossary: character inventory sorted by count
  }
}


package "src.registration — Image Alignment" as reg_pkg #F3E5F5 {

  abstract class Transformation {
    +{abstract} jacobian(xx, yy)
    +{abstract} warp(img_batch, mode, padding_mode)
    +{abstract} inv : Transformation
    +{abstract} compose(other) : Transformation
    +visibility_mask(H, W, delta)
    +__matmul__(other)
  }

  class PlanarTransform {
    transform_type : str  «translation|euclidean|affinity|homography»
    matrix : Tensor (B, 3, 3)
    - -
    +warp(img_batch) : Tensor
    +inv : PlanarTransform
    +compose(other) : PlanarTransform
    +scale(factor) : PlanarTransform
    +jacobian(xx, yy) : Tensor
    +visibility_mask(H, W, delta) : Tensor
  }

  class InverseCompositional {
    transform_type : str
    gradient_method : Gradients
    error_function : str «lorentzian|geman_mcclure|quadratic»
    max_iter, epsilon
    - -
    +run(I1, I2, p_init) : PlanarTransform
    .. Gauss-Newton on Hessian ..
    .. robust error functions ..
    .. fully batched (B pairs) ..
  }

  class GaussianPyramid {
    eta, sigma_0, N_scales, min_size
    - -
    +__call__(img) : List[Tensor]
    .. coarse-to-fine image stack ..
  }

  class MultiscaleIC {
    ic : InverseCompositional
    pyramid : GaussianPyramid
    first_scale : int
    - -
    +run(I1, I2, p_init) : PlanarTransform
    .. coarse → fine IC alignment ..
  }

  class Gradients {
    method : str
    C : int
    - -
    +__call__(image) : (Ix, Iy)
    .. separable convolution ..
    .. supports: central, farid3, farid5 ..
  }

  Transformation <|- - PlanarTransform
  MultiscaleIC - -> InverseCompositional : uses
  MultiscaleIC - -> GaussianPyramid : uses
  InverseCompositional - -> PlanarTransform : produces
  InverseCompositional - -> Gradients : uses
}


package "src.registration — Cluster Alignment" as align_pkg #F3E5F5 {

  class "<<module>> alignment_utils" as align_utils {
    +create_default_aligner(device) : MultiscaleIC
    +pairwise_align(aligner, I1, I2) : (PlanarTransform, float)
    +warp_image(image, transform) : Tensor
    +median_template(aligned) : Tensor
  }

  class MSTAlignment {
    k_neighbors, n_refinement_rounds
    aligner : MultiscaleIC
    - -
    +align_cluster(images, nlfa_sub, distance_sub) : dict
    ..
    1. Select medoid (min total distance)
    2. k-NN edge set from NLFA
    3. Pairwise IC residuals
    4. Scipy MST construction
    5. BFS transform propagation from root
    6. Median template + refinement rounds
  }

  class Congealing {
    n_alternations : int
    aligner : MultiscaleIC
    - -
    +congeal(images, medoid_idx) : dict
    ..
    Alternating optimization:
    1. Fix transforms → median template
    2. Fix template → IC registration per image
    Repeat n_alternations times.
  }

  MSTAlignment - -> align_utils : uses
  Congealing - -> align_utils : uses
  align_utils - -> MultiscaleIC : creates
  align_utils - -> PlanarTransform : uses
}


package "src.clustering — Deformation Features" as deform_pkg #FFF3E0 {

  class ShapeContextDescriptor {
    n_sample_points, n_angular_bins, n_radial_bins
    - -
    +describe(binary) : ndarray (N_s, n_bins)
    +distance(desc_a, desc_b) : float
    .. contour sampling ..
    .. log-polar histograms ..
    .. chi-squared + Hungarian matching ..
  }

  class PersistentHomologyDescriptor {
    +compute_persistence(binary) : dict {H0, H1}
    +wasserstein_distance(dgm_a, dgm_b, q) : float
    +topological_distance(img_a, img_b) : float
    .. gudhi cubical complex ..
    .. distance transform filtration ..
    .. H0 = components, H1 = loops ..
  }

  class TopologicalPreFilter {
    _ph : PersistentHomologyDescriptor
    _thresh : float
    - -
    +signature(binary) : (n_comp, n_loops)
    +compatibility_mask(signatures) : ndarray (N,N)
  }

  TopologicalPreFilter - -> PersistentHomologyDescriptor : uses
}


package "src.clustering — Evaluation" as eval_pkg #E0F7FA {

  class "<<module>> metrics" as metrics_mod {
    +compute_metrics(ref, pred) : dict
    +compute_purity(ref, pred) : float
    +compute_clustering_f1(ref, pred) : float
    +compute_accuracy_hungarian(ref, pred) : float
    +compute_per_class_f1(ref, pred) : DataFrame
    +compute_noise_fraction(labels) : float
    ..
    ARI, NMI, AMI, FMI, V-measure,
    homogeneity, completeness, purity,
    inverse purity, pairwise F1,
    Hungarian-matched accuracy
  }

  class AblationRunner {
    ablations : List[AblationConfig]
    +add_ablation(config)
    +run(pipeline_fn, data, default_params, ref) : DataFrame
  }
  class AblationConfig <<dataclass>> {
    name, description
    parameter_name, parameter_values
    default_value
  }

  class "<<module>> evaluation" as eval_mod {
    +bootstrap_metrics(ref, pred, n_bootstrap) : dict
    +paired_significance_test(ref, a, b) : dict
    +get_feature_ablations() : List[AblationConfig]
    +get_acontrario_ablations()
    +get_clustering_ablations()
    +get_refinement_ablations()
    +run_scalability_benchmark(stages, subsets) : DataFrame
  }

  AblationRunner - -> AblationConfig : has many
  AblationRunner - -> metrics_mod : uses
  eval_mod - -> metrics_mod : uses
}


package "src.layout_analysis" as layout_pkg #E3F2FD {
  class ReadingOrder {
    min_col_area : int
    - -
    +__call__(labels, page_df, ...) : fig
    .. assigns reading_order column ..
  }

  class "<<module>> parsing" as parsing_mod {
    +split_to_rectangles(labels, min_col_area) : DataFrame
    +break_into_subcols(col_rects) : list
  }

  class "<<module>> skew" as skew_mod {
    +get_document_orientation(image) : float
  }
}


package "src.ocr.chat" as chat_pkg #E8F5E9 {
  class ModelWrapper {
    net : kraken model
    pad : int
    - -
    +predict(image) : (chars, confs)
  }
}


package "scripts" as scripts_pkg {
  class "run_extraction.py" as run_extraction <<script>> {
    Runs GlobalPipeline on document images.
    Saves connectedComponent .npz files.
  }
  class "run_preprocessing.py" as run_preprocessing <<script>> {
    Runs PatchPreprocessing.
    Produces DataFrame with SVGs + HOG + OCR.
  }
  class "sweep_clustering.py" as sweep_clustering <<script>> {
    Runs graphClusteringSweep.
    Produces clustering reports.
  }
}


run_extraction - -> GlobalPipeline
run_preprocessing - -> PatchPreprocessing
sweep_clustering - -> graphClusteringSweep

GlobalPipeline ..> connectedComponent : produces characters

PatchPreprocessing ..> connectedComponent : loads from .npz
PatchPreprocessing - -> ModelWrapper : OCR predictions

graphClusteringSweep - -> Renderer : creates per config
graphClusteringSweep - -> HOG : computes features
graphClusteringSweep ..> featureMatching : NLFA matrix
graphClusteringSweep ..> post_mod : post-clustering

HausdorffSplitStep - -> MultiscaleIC : IC registration
PCAZScoreRematchStep - -> MultiscaleIC : IC registration

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.10+7-Ubuntu-124.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>