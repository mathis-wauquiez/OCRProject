% ============================================================================
%  Main document — A Contrario Character Clustering from Historical Documents
%
%  Compile with: pdflatex main.tex  (twice for references)
%  Or use:       latexmk -pdf main.tex
% ============================================================================
\documentclass[11pt, a4paper]{article}

% ── Geometry ──
\usepackage[margin=2.5cm]{geometry}

% ── Encoding & Fonts ──
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}

% ── Math ──
\usepackage{amsmath, amssymb, amsfonts}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

% ── Graphics ──
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{subcaption}

% ── TikZ ──
\usepackage{tikz}
\usetikzlibrary{
    arrows.meta,
    positioning,
    shapes.geometric,
    shapes.misc,
    calc,
    fit,
    backgrounds,
    decorations.pathreplacing,
}

% ── Tables ──
\usepackage{booktabs}
\usepackage{multirow}

% ── Algorithms ──
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}

% ── Hyperlinks ──
\usepackage[colorlinks=true, linkcolor=blue!60!black, citecolor=green!50!black, urlcolor=blue!70]{hyperref}

% ── CJK support (for character examples) ──
% Uncomment if CJK fonts are available on your system:
% \usepackage{CJKutf8}

% ── Misc ──
\usepackage{microtype}
\usepackage{enumitem}


% ============================================================================
\title{%
    Unsupervised Character Clustering in Historical Document Images\\
    via A Contrario Feature Matching%
}
\author{}
\date{}

\begin{document}
\maketitle

% ============================================================================
%  Abstract
% ============================================================================
\begin{abstract}
We present an unsupervised pipeline for clustering individual character glyphs extracted from scanned historical document images.
The method combines a learned text detector (CRAFT) for character-level extraction, Histogram of Oriented Gradients (HOG) descriptors for visual representation, and an \textit{a contrario} statistical framework for principled pairwise matching.
The resulting similarity graph is partitioned using community detection (Leiden algorithm), followed by a composable refinement pipeline that fuses visual and linguistic signals.
We further propose and evaluate four alternative clustering strategies---HDBSCAN with NFA-derived distances, Affinity Propagation on NFA similarities, Markov Random Field inference with loopy belief propagation, and K-medoids with spectral split/merge---as well as two registration methods for intra-cluster alignment (MST-based hierarchical alignment and congealing with robust median templates) and deformation-invariant features (Shape Context descriptors and persistent homology) for registration-free comparison.
Comprehensive ablation studies and a rigorous evaluation protocol with bootstrap significance testing are provided.
\end{abstract}

% ============================================================================
%  1. Introduction
% ============================================================================
\section{Introduction}
\label{sec:introduction}

Historical document analysis requires identifying and grouping recurrent character forms---a task complicated by varying handwriting styles, ink degradation, and the absence of labelled training data.
Unlike modern OCR systems trained on millions of annotated examples, historical scripts often lack sufficient ground truth for supervised approaches.

We propose a fully unsupervised pipeline that:
\begin{enumerate}[nosep]
    \item detects individual characters using a pre-trained text detector without fine-tuning;
    \item describes each character via HOG features computed on vectorised representations;
    \item determines similarity through an \textit{a contrario} statistical test that provides a principled, adaptive threshold without manual tuning;
    \item clusters characters via graph-based community detection with multi-stage refinement.
\end{enumerate}

Beyond this baseline pipeline, we develop and compare several methodological improvements at each stage:
\begin{itemize}[nosep]
    \item \textbf{Clustering:} HDBSCAN on continuous NFA distances (automatic $K$, noise handling), Affinity Propagation (exemplar-based), and Markov Random Field fusion of visual and OCR signals (Section~\ref{sec:proposed-clustering}).
    \item \textbf{Refinement:} K-medoids with NFA-guided spectral split/merge replacing three ad hoc stages (Section~\ref{sec:proposed-refinement}).
    \item \textbf{Registration:} MST-based hierarchical alignment and congealing with robust median templates for sharp, drift-bounded intra-cluster alignment (Section~\ref{sec:proposed-registration}).
    \item \textbf{Features:} Shape Context descriptors and persistent homology for deformation-invariant comparison and topological pre-filtering (Section~\ref{sec:proposed-features}).
\end{itemize}

The paper is organised as follows.
Section~\ref{sec:methodology} describes the baseline pipeline.
Section~\ref{sec:proposed-methods} presents the proposed improvements.
Section~\ref{sec:experiments} details the experiment plan, ablation studies, and evaluation protocol.
Section~\ref{sec:conclusion} concludes.


% ============================================================================
%  2. Methodology (baseline pipeline)
% ============================================================================
\input{methodology}


% ============================================================================
%  3. Proposed Methods
% ============================================================================
\input{proposed_methods}


% ============================================================================
%  4. Experiments
% ============================================================================
\input{experiments}


% ============================================================================
%  5. Conclusion
% ============================================================================
\section{Conclusion}
\label{sec:conclusion}

We have presented a comprehensive unsupervised pipeline for character clustering in historical document images, grounded in the \textit{a contrario} statistical framework.
The baseline pipeline---CRAFT detection, HOG features, NFA matching, Leiden clustering, and three-stage refinement---provides a strong starting point.
The proposed improvements (HDBSCAN clustering, MRF fusion, K-medoids split/merge, MST alignment, congealing, and topological features) address specific limitations of the baseline at each stage.
The ablation framework and evaluation protocol enable rigorous comparison of all components.
Future work will focus on cross-corpus generalisation and integration of learned feature representations.


% ============================================================================
%  References
% ============================================================================
\bibliographystyle{plain}
% \bibliography{references}  % uncomment when references.bib is available

% ── Inline references for standalone compilation ──
\begin{thebibliography}{99}

\bibitem{baek2019character}
Y.~Baek, B.~Lee, D.~Han, S.~Yun, and H.~Lee.
\newblock Character region awareness for text detection.
\newblock In \emph{Proc.\ IEEE/CVF CVPR}, pp.~9365--9374, 2019.

\bibitem{dalal2005histograms}
N.~Dalal and B.~Triggs.
\newblock Histograms of oriented gradients for human detection.
\newblock In \emph{Proc.\ IEEE CVPR}, vol.~1, pp.~886--893, 2005.

\bibitem{desolneux2000meaningful}
A.~Desolneux, L.~Moisan, and J.-M.~Morel.
\newblock Meaningful alignments.
\newblock \emph{Int.\ J.\ Comput.\ Vis.}, 40(1):7--23, 2000.

\bibitem{briand2018ipol}
T.~Briand, G.~Facciolo, and J.~S\'anchez.
\newblock A detailed study of the modified inverse compositional algorithm.
\newblock \emph{Image Processing On Line (IPOL)}, 8:311--364, 2018.

\bibitem{traag2019louvain}
V.~A.~Traag, L.~Waltman, and N.~J.~van Eck.
\newblock From {Louvain} to {Leiden}: guaranteeing well-connected communities.
\newblock \emph{Scientific Reports}, 9(1):5233, 2019.

\bibitem{von2010lsd}
R.~Grompone~von Gioi, J.~Jakubowicz, J.-M.~Morel, and G.~Randall.
\newblock {LSD}: a line segment detector.
\newblock \emph{Image Processing On Line (IPOL)}, 2:35--55, 2012.

\bibitem{kiessling2019kraken}
B.~Kiessling.
\newblock Kraken --- an universal text recognizer for the humanities.
\newblock In \emph{Proc.\ Digital Humanities}, 2019.

\bibitem{hubert1985comparing}
L.~Hubert and P.~Arabie.
\newblock Comparing partitions.
\newblock \emph{J.\ Classification}, 2(1):193--218, 1985.

\bibitem{rosenberg2007v}
A.~Rosenberg and J.~Hirschberg.
\newblock V-measure: A conditional entropy-based external cluster evaluation measure.
\newblock In \emph{Proc.\ EMNLP-CoNLL}, pp.~410--420, 2007.

\bibitem{rony2025hausdorff}
J.~Rony and H.~Kervadec.
\newblock Distorch: fast differentiable boundary distances.
\newblock In \emph{Proc.\ MIDL}, 2025.

\bibitem{frey2007clustering}
B.~J.~Frey and D.~Dueck.
\newblock Clustering by passing messages between data points.
\newblock \emph{Science}, 315(5814):972--976, 2007.

\bibitem{mcinneshdbscan2017}
L.~McInnes, J.~Healy, and S.~Astels.
\newblock hdbscan: Hierarchical density based clustering.
\newblock \emph{J.\ Open Source Software}, 2(11):205, 2017.

\bibitem{belongie2002shape}
S.~Belongie, J.~Malik, and J.~Puzicha.
\newblock Shape matching and object recognition using shape contexts.
\newblock \emph{IEEE Trans.\ PAMI}, 24(4):509--522, 2002.

\bibitem{edelsbrunner2008persistent}
H.~Edelsbrunner and J.~Harer.
\newblock Persistent homology---a survey.
\newblock In \emph{Surveys on Discrete and Computational Geometry}, pp.~257--282, AMS, 2008.

\bibitem{learned2004data}
E.~Learned-Miller.
\newblock Data driven image models through continuous joint alignment.
\newblock \emph{IEEE Trans.\ PAMI}, 28(2):236--250, 2006.

\bibitem{yedidia2003understanding}
J.~S.~Yedidia, W.~T.~Freeman, and Y.~Weiss.
\newblock Understanding belief propagation and its generalizations.
\newblock In \emph{Exploring AI in the New Millennium}, pp.~239--269, 2003.

\end{thebibliography}

\end{document}
