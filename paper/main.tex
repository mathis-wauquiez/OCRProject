% ============================================================================
%  Main document — A Contrario Character Clustering from Historical Documents
%
%  ICDAR / Springer LNCS format
%  Compile with: pdflatex main.tex  (twice for references)
% ============================================================================
\documentclass[runningheads]{llncs}

% ── Encoding & Fonts ──
\usepackage[T1]{fontenc}

% ── Math ──
\usepackage{amsmath, amssymb, amsfonts}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

% ── Graphics ──
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{subcaption}

% ── TikZ ──
\usepackage{tikz}
\usetikzlibrary{
    arrows.meta,
    positioning,
    shapes.geometric,
    shapes.misc,
    calc,
    fit,
    backgrounds,
    decorations.pathreplacing,
}

% ── Tables ──
\usepackage{booktabs}
\usepackage{multirow}

% ── Algorithms ──
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}

% ── Hyperlinks ──
\usepackage[colorlinks=true, linkcolor=blue!60!black, citecolor=green!50!black, urlcolor=blue!70]{hyperref}

% ── Misc ──
\usepackage{enumitem}


% ============================================================================
\title{%
    Unsupervised Character Clustering in Historical Document Images
    via A Contrario Feature Matching%
}
\titlerunning{A Contrario Character Clustering}

\author{Anonymous Author(s)}
\authorrunning{Anonymous}
\institute{Anonymous Institution}

\begin{document}
\maketitle

% ============================================================================
%  Abstract
% ============================================================================
\begin{abstract}
We present an unsupervised pipeline for clustering individual character glyphs extracted from scanned historical document images.
The method combines a learned text detector (CRAFT) for character-level extraction, Histogram of Oriented Gradients (HOG) descriptors for visual representation, and an \textit{a contrario} statistical framework for principled pairwise matching.
The resulting similarity graph is partitioned using community detection (Leiden algorithm), followed by a composable refinement pipeline that fuses visual and linguistic signals.
We further propose and evaluate alternative clustering strategies---HDBSCAN with NFA-derived distances, Affinity Propagation, and Markov Random Field inference---as well as registration methods for intra-cluster alignment and deformation-invariant features for registration-free comparison.
Comprehensive ablation studies and a rigorous evaluation protocol with bootstrap significance testing are provided.

\keywords{Historical document analysis \and Character clustering \and A contrario methods \and HOG features \and Community detection}
\end{abstract}


% ============================================================================
%  1. Introduction
% ============================================================================
\section{Introduction}
\label{sec:introduction}

Historical document analysis requires identifying and grouping recurrent character forms---a task complicated by varying handwriting styles, ink degradation, and the absence of labelled training data.
Unlike modern OCR systems trained on millions of annotated examples, historical scripts often lack sufficient ground truth for supervised approaches.

We propose a fully unsupervised pipeline that:
\begin{enumerate}[nosep]
    \item detects individual characters using a pre-trained text detector without fine-tuning;
    \item describes each character via HOG features computed on vectorised representations;
    \item determines similarity through an \textit{a contrario} statistical test that provides a principled, adaptive threshold without manual tuning;
    \item clusters characters via graph-based community detection with multi-stage refinement.
\end{enumerate}

Beyond this baseline pipeline, we develop and compare several methodological improvements:
\begin{itemize}[nosep]
    \item \textbf{Clustering:} HDBSCAN on continuous NFA distances, Affinity Propagation, and Markov Random Field fusion of visual and OCR signals (Sect.~\ref{sec:proposed-clustering}).
    \item \textbf{Refinement:} K-medoids with NFA-guided spectral split/merge (Sect.~\ref{sec:proposed-refinement}).
    \item \textbf{Registration:} MST-based hierarchical alignment and congealing with robust median templates (Sect.~\ref{sec:proposed-registration}).
    \item \textbf{Features:} Shape Context descriptors and persistent homology for deformation-invariant comparison (Sect.~\ref{sec:proposed-features}).
\end{itemize}

The paper is organised as follows.
Section~\ref{sec:methodology} describes the baseline pipeline.
Section~\ref{sec:proposed-methods} presents the proposed improvements.
Section~\ref{sec:experiments} details the experiment plan and evaluation protocol.
Section~\ref{sec:conclusion} concludes.


% ============================================================================
%  2. Methodology (baseline pipeline)
% ============================================================================
\input{methodology}


% ============================================================================
%  3. Proposed Methods
% ============================================================================
\input{proposed_methods}


% ============================================================================
%  4. Experiments
% ============================================================================
\input{experiments}


% ============================================================================
%  5. Conclusion
% ============================================================================
\section{Conclusion}
\label{sec:conclusion}

We have presented a comprehensive unsupervised pipeline for character clustering in historical document images, grounded in the \textit{a contrario} statistical framework.
The baseline pipeline---CRAFT detection, HOG features, NFA matching, Leiden clustering, and three-stage refinement---provides a strong starting point.
The proposed improvements (HDBSCAN clustering, MRF fusion, K-medoids split/merge, MST alignment, congealing, and topological features) address specific limitations at each stage.
The ablation framework and evaluation protocol enable rigorous comparison of all components.
Future work will focus on cross-corpus generalisation and integration of learned feature representations.


% ============================================================================
%  References
% ============================================================================
\bibliographystyle{splncs04}
% \bibliography{references}  % uncomment when references.bib is available

% ── Inline references for standalone compilation ──
\begin{thebibliography}{16}

\bibitem{baek2019character}
Baek, Y., Lee, B., Han, D., Yun, S., Lee, H.:
Character region awareness for text detection.
In: Proc.\ IEEE/CVF CVPR, pp.~9365--9374 (2019)

\bibitem{dalal2005histograms}
Dalal, N., Triggs, B.:
Histograms of oriented gradients for human detection.
In: Proc.\ IEEE CVPR, vol.~1, pp.~886--893 (2005)

\bibitem{desolneux2000meaningful}
Desolneux, A., Moisan, L., Morel, J.-M.:
Meaningful alignments.
Int.\ J.\ Comput.\ Vis.\ \textbf{40}(1), 7--23 (2000)

\bibitem{briand2018ipol}
Briand, T., Facciolo, G., S\'anchez, J.:
A detailed study of the modified inverse compositional algorithm.
Image Processing On Line (IPOL) \textbf{8}, 311--364 (2018)

\bibitem{traag2019louvain}
Traag, V.A., Waltman, L., van Eck, N.J.:
From {Louvain} to {Leiden}: guaranteeing well-connected communities.
Scientific Reports \textbf{9}(1), 5233 (2019)

\bibitem{von2010lsd}
Grompone~von~Gioi, R., Jakubowicz, J., Morel, J.-M., Randall, G.:
{LSD}: a line segment detector.
Image Processing On Line (IPOL) \textbf{2}, 35--55 (2012)

\bibitem{kiessling2019kraken}
Kiessling, B.:
Kraken --- an universal text recognizer for the humanities.
In: Proc.\ Digital Humanities (2019)

\bibitem{hubert1985comparing}
Hubert, L., Arabie, P.:
Comparing partitions.
J.\ Classification \textbf{2}(1), 193--218 (1985)

\bibitem{rosenberg2007v}
Rosenberg, A., Hirschberg, J.:
V-measure: A conditional entropy-based external cluster evaluation measure.
In: Proc.\ EMNLP-CoNLL, pp.~410--420 (2007)

\bibitem{rony2025hausdorff}
Rony, J., Kervadec, H.:
Distorch: fast differentiable boundary distances.
In: Proc.\ MIDL (2025)

\bibitem{frey2007clustering}
Frey, B.J., Dueck, D.:
Clustering by passing messages between data points.
Science \textbf{315}(5814), 972--976 (2007)

\bibitem{mcinneshdbscan2017}
McInnes, L., Healy, J., Astels, S.:
hdbscan: Hierarchical density based clustering.
J.\ Open Source Software \textbf{2}(11), 205 (2017)

\bibitem{belongie2002shape}
Belongie, S., Malik, J., Puzicha, J.:
Shape matching and object recognition using shape contexts.
IEEE Trans.\ PAMI \textbf{24}(4), 509--522 (2002)

\bibitem{edelsbrunner2008persistent}
Edelsbrunner, H., Harer, J.:
Persistent homology---a survey.
In: Surveys on Discrete and Computational Geometry, pp.~257--282. AMS (2008)

\bibitem{learned2004data}
Learned-Miller, E.:
Data driven image models through continuous joint alignment.
IEEE Trans.\ PAMI \textbf{28}(2), 236--250 (2006)

\bibitem{yedidia2003understanding}
Yedidia, J.S., Freeman, W.T., Weiss, Y.:
Understanding belief propagation and its generalizations.
In: Exploring AI in the New Millennium, pp.~239--269 (2003)

\end{thebibliography}

\end{document}
